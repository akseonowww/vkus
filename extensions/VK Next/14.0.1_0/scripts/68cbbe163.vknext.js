"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[7425],{45445:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(53644),s=n(43027);const r="pjnmruE51lp5H9IJ",i=({icon:e,onClick:t})=>{const n=document.createElement("button");return n.className=r,n.appendChild((0,o.A)(e)),t&&n.addEventListener("click",(e=>{(0,s.A)(e),t(e)})),n}},13851:(e,t,n)=>{n.d(t,{A:()=>S});var o=n(1145),s=n(67992),r=n(38729),i=n(92128);const a=[".ForeignMessageModal__body"].join(","),l=new s.A,c=(0,r.NS)(),d=(0,r.sr)(),u=e=>{if(!e[d]){e[d]=!0;for(const t of l.listeners)t(e)}},h=()=>{for(const e of document.querySelectorAll(a))u(e)},m=async()=>{(0,i.A)((e=>{var t;(t=e)[c]||(t[c]=new MutationObserver((e=>{for(const t of e)for(const e of t.addedNodes)if(e instanceof HTMLElement)for(const t of e.querySelectorAll(a))u(t)})),t[c].observe(t,{childList:!0}));for(const t of e.querySelectorAll(a))u(t)}))};let p=!1;const f=e=>{const t=l.addListener(e);return(0,o.A)(h),p||(p=!0,m()),t},v=[".ForwardedMessage"].join(","),g=new s.A,_=(0,r.sr)(),A=e=>{if(!e[_]){e[_]=!0;for(const t of g.listeners)t(e)}},y=()=>{for(const e of document.querySelectorAll(v))A(e)};let w=!1;const S=e=>{const t=g.addListener(e);return(0,o.A)(y),w||(w=!0,(async()=>{f((e=>{for(const t of e.querySelectorAll(v))A(t)}))})()),t}},92128:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(1145),s=n(67992),r=n(38729),i=n(47648);const a=["#reforged-modal-root",".VKCOMMessenger__reforgedModalRoot","#fastchat-reforged-modals"].join(","),l=new s.A,c=(0,r.sr)(),d=e=>{if(!e[c]){e[c]=!0;for(const t of l.listeners)t(e)}},u=()=>{for(const e of document.querySelectorAll(a))d(e)};let h=!1;const m=e=>{const t=l.addListener(e);return(0,o.A)(u),h||(h=!0,(0,i.A)((e=>{const t=e.closest(".vkui__root");if(t)for(const e of t.querySelectorAll(a))d(e)}))),t}},47648:(e,t,n)=>{n.d(t,{A:()=>p});var o=n(49032),s=n(1145),r=n(14943),i=n(67992),a=n(38729),l=n(4107);const c=(0,a.sr)(),d=new i.A,u=()=>{if(document.querySelector(".im-page:not(.im-page_group)"))return void setTimeout(u,1e3);const e=document.querySelector("#reforged-root,.VKCOMMessenger__reforgedRoot");e?e.querySelector(".VKCOMMessenger__skeletonWrapper")?setTimeout(u,500):(e=>{if(!e[c]){e[c]=!0;for(const t of d.listeners)t(e)}})(e):0===document.getElementById("wrap3")?.children.length&&setTimeout(u,500)},h=async e=>{if(document.getElementsByClassName("im-page")[0]&&!e)return void(0,s.A)((()=>h(!0)));const t=await(0,l.A)();u(),t.onLocationChange((async e=>{await(0,r.A)(),o.lz.test(e)&&u()}))};let m=!1;const p=e=>{const t=d.addListener(e);return(0,s.A)(u),m||(m=!0,h()),t}},9794:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{A:()=>d});var s=n(387),r=n(26555),i=n(52352),a=n(93819);const e=await a.A;let l=0;class c{id;listeners=new Map;icon;title;subtitle;progressTotal;progress;onCancel;timeLeft;indicator;progressText;iconUrl;_bytesPerSecond;startTime;interval;constructor(e){const t=e;this.id=`${l++}_${(0,s.A)()}`;const n=this.notifyListeners.bind(this),o=["title","subtitle","progress","progressTotal","onCancel","icon","timeLeft","indicator","progressText","iconUrl"];for(const e of o)Object.defineProperty(this,e,{get:()=>t[e],set(o){t[e]=o,n(e,o)}});this._bytesPerSecond=0,this.startTime=Date.now()}notifyListeners=(e,t)=>{if(this.listeners.has(e))for(const n of this.listeners.get(e))n(t)};addChangePropertyListener=(e,t)=>{const n=this.listeners.get(e)||new Set;return n.add(t),this.listeners.set(e,n),()=>{n.delete(t),this.listeners.set(e,n)}};updateBytesPerSecond=e=>{this._bytesPerSecond+=e};updateTimeLeft=(t,n=this.progress,o=this.progressTotal,s=0)=>{if(void 0===n)return;s||(s=(0,i.A)(n,0,o||100)),this.updateBytesPerSecond(t);const r=Date.now()-this.startTime;let a=`0${e.use("vkcom_time_s")}`;s<100&&(a=new Date(100*r/s-r),a=[[a.getUTCFullYear()-1970,e.use("vkcom_time_y")],[a.getUTCMonth(),e.use("vkcom_time_mo")],[a.getUTCDate()-1,e.use("vkcom_time_d")],[a.getUTCHours(),e.use("vkcom_time_h")],[a.getUTCMinutes(),e.use("vkcom_time_m")],[a.getUTCSeconds(),e.use("vkcom_time_s")]].filter((e=>!!e[0])).slice(0,2).map((e=>e.join(""))).join(" ")||`0${e.use("vkcom_time_s")}`),this.timeLeft=a};startSpeed(){return this.stopSpeed(),this.indicator=(0,r.A)(0),this.interval=setInterval((()=>{this.indicator=(0,r.A)(this._bytesPerSecond)+"/s",this._bytesPerSecond=0}),1e3),()=>{this.stopSpeed()}}clearIndicator(){this.stopSpeed(),this.progress=this.progressTotal=this.timeLeft=this.indicator=void 0}stopSpeed(){this.interval&&(clearInterval(this.interval),delete this.interval)}}const d=c;o()}catch(e){o(e)}}),1)},4336:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(74848),s=n(1145),r=n(3068),i=n(70459);const a=new class{wrapper=document.createElement("li");_unsafeUnmount=null;listeners=[];events=[];getEvents(){return[...this.events]}addEvent(e){return this.events.push(e),this.onEventsChange(),()=>{this.events=this.events.filter((t=>t!==e)),this.onEventsChange()}}removeEvent(e){this.events=this.events.filter((t=>t.id!==e)),this.onEventsChange()}addEventsChangeListener(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}onEventsChange(){for(const e of this.listeners)e(this.getEvents());this.events.length>=1?(0,s.A)((()=>this.renderManager())):this.removeManager()}async downloadFileFromLink(e,t){const o=(await n.e(7746).then(n.bind(n,37746))).default;await o(e,t)}async renderManager(){if(this.wrapper.parentElement)return;this.wrapper.className="HeaderNav__item";const e=document.querySelector(".HeaderNav,#top_nav");if(!e)return void console.error("HeaderNav not found");const t=e.querySelector(".HeaderNav__audio");t?(t.insertAdjacentElement("afterend",this.wrapper),this.wrapper.style.order=""):(e.appendChild(this.wrapper),this.wrapper.style.order="-1"),this._unsafeUnmount&&this._unsafeUnmount();const{default:s}=await Promise.all([n.e(2551),n.e(7983),n.e(2020),n.e(3543),n.e(9452),n.e(2477),n.e(6052)]).then(n.bind(n,86052)),{unmount:a}=await(0,r.A)({root:this.wrapper,content:(0,o.jsx)(s,{}),disableParentTransformForPositionFixedElements:!0,disablePortal:!0,wrapperProps:{className:i.A.DownloadManagerPopup}});this._unsafeUnmount=a}removeManager(){0===this.events.length&&(this.wrapper.parentElement&&this.wrapper.remove(),this._unsafeUnmount&&(this._unsafeUnmount(),this._unsafeUnmount=null))}}},88298:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{N:()=>r.A,j:()=>s.A});var s=n(9794),r=n(4336),i=e([s]);s=(i.then?(await i)():i)[0],o()}catch(e){o(e)}}))},57425:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.r(t);var s=n(95728),r=n(88257),i=n(45445),a=n(13851),l=n(32441),c=n(88298),d=e([c]);c=(d.then?(await d)():d)[0];const u=e=>{const{fiber:t}=(0,s.A)(e),{linkMp3:n,ownerId:o,id:r}=t.return.memoizedProps.message.attaches.voice,i=[o,r].join("_");c.N.downloadFileFromLink(n,`audio_message${i}.mp3`)},h=e=>{for(const t of e.querySelectorAll(".AttachVoice__player")){if(t.vkn_down_inj)continue;t.vkn_down_inj=!0;const n=(0,i.A)({icon:r.A,onClick:t=>{if(!t.target)return;const n=t.target.closest(".AttachVoice");u(n||e)}});t.appendChild(n)}};(0,l.A)(h),(0,a.A)(h),o()}catch(e){o(e)}}))},53644:(e,t,n)=>{n.d(t,{A:()=>s});let o=0;const s=e=>{const t=!!document.importNode;let n=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;t&&(n=document.importNode(n,!0));for(const e of n.querySelectorAll("title,desc"))e.remove();for(const e of n.querySelectorAll("[id]")){if(!e.id)continue;const t="vknext_icon-"+o++;let s=!1;for(const o of n.querySelectorAll(`[fill="url(#${e.id})"]`))o.setAttribute("fill",`url(#${t})`),s=!0;s&&(e.id=t)}return n}},43027:(e,t,n)=>{n.d(t,{A:()=>o});const o=e=>{e.preventDefault?.(),e.stopPropagation?.(),e.stopImmediatePropagation?.()}},52352:(e,t,n)=>{n.d(t,{A:()=>o});const o=(e,t,n)=>e<t?0:e>n?100:(e-t)/(n-t)*100},70459:(e,t,n)=>{n.d(t,{A:()=>o});const o={AudioPageMainTabBtn:"XYzoAKWs2KhH02Ye",AudioArtistHeaderActions:"v8VBorduCtZgTyyi",VideoPlayerDownloadIcon:"eaSw45y_1KLlo4Gw",SecondaryAttachment__afterItem:"RZ6NWD1WvjAOxG2Y",DownloadManagerPopup:"o9vy1XhnZrkvykUb",VideoPlayerHlsWarning__tooltip:"P9MhdlrtilEQt7Am",VideoPlayerHlsWarning__text:"Xq2PVks6OK6Z74Al",AudioPlaylistSnippet__actions:"FawmW4_Zd1R1BI1E",AudioPlaylistSnippet__actionButton:"ZPr5mXzL52VUPaRe",ActionButton__icon:"_5bFyslOmNjqqP7y",ActionButton__text:"o7YAH98fI9KVToa5",AudioPlayerUserControlsContainer__userButton:"e47qq1XqMPp6oTp7",AudioPlayerPlaybackButton:"wqb5e3cgYZFgHCc1",AudioRowReact__button:"q7d6KTdMjs6HYpKm"}},88257:(e,t,n)=>{n.d(t,{A:()=>o});const o='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M8.75 1.75a.75.75 0 0 0-1.5 0v6.6893L5.0303 6.2197a.75.75 0 0 0-1.0606 1.0606l3.5 3.5a.7498.7498 0 0 0 1.0606 0l3.5-3.5a.75.75 0 0 0-1.0606-1.0606L8.75 8.4393V1.75Zm-6 10.75a.75.75 0 0 0 0 1.5h10.5a.75.75 0 0 0 0-1.5H2.75Z" clip-rule="evenodd"/></svg>\n'}}]);