"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[6076,5560],{85560:(e,t,a)=>{a.d(t,{default:()=>n});var o=a(79384),r=a(52815);const n=async()=>{const e=await(0,r.A)(),t=(0,o.A)(e[0][1]),a=(0,o.A)(e[1][1]);return!!(107<=t&&t<=110&&107<=a&&a<=110)}},74732:(e,t,a)=>{a.d(t,{A:()=>s});var o=a(35277);const r=async(e,t)=>{const a=await(0,o._)({url:e,filename:t,type:"convertM3u8ToMp4"});return new File([a],t,{type:"video/mp4"})};var n=a(36008);const s=async(e,t)=>(await n.default.sendMessage("vkn-b-aath",new URL(e).origin+"/*"),await r(e,t))},9794:(e,t,a)=>{a.a(e,(async(e,o)=>{try{a.d(t,{A:()=>d});var r=a(387),n=a(26555),s=a(52352),i=a(93819);const e=await i.A;let c=0;class l{id;listeners=new Map;icon;title;subtitle;progressTotal;progress;onCancel;timeLeft;indicator;progressText;iconUrl;_bytesPerSecond;startTime;interval;constructor(e){const t=e;this.id=`${c++}_${(0,r.A)()}`;const a=this.notifyListeners.bind(this),o=["title","subtitle","progress","progressTotal","onCancel","icon","timeLeft","indicator","progressText","iconUrl"];for(const e of o)Object.defineProperty(this,e,{get:()=>t[e],set(o){t[e]=o,a(e,o)}});this._bytesPerSecond=0,this.startTime=Date.now()}notifyListeners=(e,t)=>{if(this.listeners.has(e))for(const a of this.listeners.get(e))a(t)};addChangePropertyListener=(e,t)=>{const a=this.listeners.get(e)||new Set;return a.add(t),this.listeners.set(e,a),()=>{a.delete(t),this.listeners.set(e,a)}};updateBytesPerSecond=e=>{this._bytesPerSecond+=e};updateTimeLeft=(t,a=this.progress,o=this.progressTotal,r=0)=>{if(void 0===a)return;r||(r=(0,s.A)(a,0,o||100)),this.updateBytesPerSecond(t);const n=Date.now()-this.startTime;let i=`0${e.use("vkcom_time_s")}`;r<100&&(i=new Date(100*n/r-n),i=[[i.getUTCFullYear()-1970,e.use("vkcom_time_y")],[i.getUTCMonth(),e.use("vkcom_time_mo")],[i.getUTCDate()-1,e.use("vkcom_time_d")],[i.getUTCHours(),e.use("vkcom_time_h")],[i.getUTCMinutes(),e.use("vkcom_time_m")],[i.getUTCSeconds(),e.use("vkcom_time_s")]].filter((e=>!!e[0])).slice(0,2).map((e=>e.join(""))).join(" ")||`0${e.use("vkcom_time_s")}`),this.timeLeft=i};startSpeed(){return this.stopSpeed(),this.indicator=(0,n.A)(0),this.interval=setInterval((()=>{this.indicator=(0,n.A)(this._bytesPerSecond)+"/s",this._bytesPerSecond=0}),1e3),()=>{this.stopSpeed()}}clearIndicator(){this.stopSpeed(),this.progress=this.progressTotal=this.timeLeft=this.indicator=void 0}stopSpeed(){this.interval&&(clearInterval(this.interval),delete this.interval)}}const d=l;o()}catch(e){o(e)}}),1)},4336:(e,t,a)=>{a.d(t,{A:()=>i});var o=a(74848),r=a(1145),n=a(3068),s=a(70459);const i=new class{wrapper=document.createElement("li");_unsafeUnmount=null;listeners=[];events=[];getEvents(){return[...this.events]}addEvent(e){return this.events.push(e),this.onEventsChange(),()=>{this.events=this.events.filter((t=>t!==e)),this.onEventsChange()}}removeEvent(e){this.events=this.events.filter((t=>t.id!==e)),this.onEventsChange()}addEventsChangeListener(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}onEventsChange(){for(const e of this.listeners)e(this.getEvents());this.events.length>=1?(0,r.A)((()=>this.renderManager())):this.removeManager()}async downloadFileFromLink(e,t){const o=(await a.e(7746).then(a.bind(a,37746))).default;await o(e,t)}async renderManager(){if(this.wrapper.parentElement)return;this.wrapper.className="HeaderNav__item";const e=document.querySelector(".HeaderNav,#top_nav");if(!e)return void console.error("HeaderNav not found");const t=e.querySelector(".HeaderNav__audio");t?(t.insertAdjacentElement("afterend",this.wrapper),this.wrapper.style.order=""):(e.appendChild(this.wrapper),this.wrapper.style.order="-1"),this._unsafeUnmount&&this._unsafeUnmount();const{default:r}=await Promise.all([a.e(2551),a.e(7983),a.e(2020),a.e(3543),a.e(9452),a.e(2477),a.e(6052)]).then(a.bind(a,86052)),{unmount:i}=await(0,n.A)({root:this.wrapper,content:(0,o.jsx)(r,{}),disableParentTransformForPositionFixedElements:!0,disablePortal:!0,wrapperProps:{className:s.A.DownloadManagerPopup}});this._unsafeUnmount=i}removeManager(){0===this.events.length&&(this.wrapper.parentElement&&this.wrapper.remove(),this._unsafeUnmount&&(this._unsafeUnmount(),this._unsafeUnmount=null))}}},88298:(e,t,a)=>{a.a(e,(async(e,o)=>{try{a.d(t,{N:()=>n.A,j:()=>r.A});var r=a(9794),n=a(4336),s=e([r]);r=(s.then?(await s)():s)[0],o()}catch(e){o(e)}}))},45161:(e,t,a)=>{a.d(t,{b:()=>r,m:()=>n});var o=a(97307);const r=async(e,t)=>await s(e,t,!0),n=async(e,t)=>await s(e,t,!1),s=async(e,t,a)=>{const r={},{usersPromises:n,groupsPromises:s}=((e,t,a)=>{const r=[],n=[],s=a?"first_name,first_name_acc,last_name,last_name_acc,photo_50":"first_name,last_name,last_name_acc",i=a?"photo_50":void 0;if(e.length)for(const t of(0,o.A)(e,1e3))r.push(vkApi.api("users.get",{user_ids:t,fields:s}));if(t.length)for(const e of(0,o.A)(t,1e3))n.push(vkApi.api("groups.getById",{group_ids:e.map((e=>-e)),fields:i}));return{usersPromises:r,groupsPromises:n}})(e,t,a);if(n.length){(await Promise.all(n)).flatMap((e=>e)).forEach((e=>{r[e.id]||(e.deactivated&&!e.first_name?r[e.id]={ins:"DELETED",acc:"DELETED",picUrl:e.photo_50}:r[e.id]=a?{ins:`${e.first_name} ${e.last_name}`,acc:`${e.first_name_acc} ${e.last_name_acc}`,picUrl:e.photo_50}:{ins:`${e.first_name&&e.first_name[0]}. ${e.last_name}`,acc:`${e.first_name&&e.first_name[0]}. ${e.last_name_acc}`})}))}if(s.length){(await Promise.all(s)).flatMap((e=>e.groups)).forEach((e=>{r[-e.id]||(r[-e.id]={name:e.name},a&&(r[-e.id].picUrl=e.photo_50))}))}return r}},42317:(e,t,a)=>{a.d(t,{A:()=>y});var o=a(43024),r=a(82050);const n=async(e,t,a=0)=>{const o=t?.retry||2,s=t?.delay||1e3;try{return await window.fetch(e,t)}catch(i){if(a<=o)return await(0,r.A)(s),await n(e,t,a+1);throw i}},s=n,i=async({attach:e,signal:t,lastModified:a,event:o})=>{if(t.aborted)return null;if("doc"!==e.type)return null;try{const r=e.doc.url;if(r){const n=await s(r,{signal:t}),i=await n.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:`docs/${e.doc.owner_id}/${e.doc.id}.${e.doc.ext||"png"}`,lastModified:a,input:new Blob([i])}}}catch(e){console.error(e)}return null},c=async({attach:e,signal:t,lastModified:a,event:o})=>{if(t.aborted)return null;if("gift"!==e.type)return null;try{const r=e.gift,n=r.thumb_512||r.thumb_256||r.thumb_128||r.thumb_96||r.thumb_48;if(n){const e=await s(n,{signal:t}),i=await e.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:`gifts/${r.id}.png`,lastModified:a,input:new Blob([i])}}}catch(e){console.error(e)}return null},l=async({attach:e,signal:t,lastModified:a,event:o})=>{if(t.aborted)return null;if("graffiti"!==e.type)return null;try{const r=e.graffiti.url;if(r){const n=await s(r,{signal:t}),i=await n.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:`graffiti/${e.graffiti.id}.png`,lastModified:a,input:new Blob([i])}}}catch(e){console.error(e)}return null};var d=a(34747);const _=async({attach:e,signal:t,lastModified:a,event:o})=>{if(t.aborted)return null;if("photo"!==e.type)return null;try{const r=(0,d.A)(e.photo.sizes||[]),n=r?.url||r?.src;if(n){const r=await s(n,{signal:t,retry:10}),i=await r.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:`photos/${e.photo.owner_id}/${e.photo.id}.jpg`,lastModified:e.photo.date?new Date(1e3*e.photo.date):a,input:new Blob([i])}}}catch(e){console.error(e)}return null};var u=a(35584);const h=async({attach:e,signal:t,lastModified:a,event:o,isDark:r})=>{if(t.aborted)return null;if("sticker"!==e.type&&"ugc_sticker"!==e.type)return null;try{const n=e[e.type],i=r&&n?.images_with_background?n?.images_with_background:n?.images;if(!i)return null;const c=(0,u.A)(i,512)?.url;if(c){const e=await s(c,{signal:t}),i=await e.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:`stickers/${n.sticker_id||n.id}${r?"b":""}.png`,lastModified:a,input:new Blob([i])}}}catch(e){console.error(e)}return null};var g=a(36008),p=a(74732),m=a(99761);const f=async({attach:e,signal:t,lastModified:a,event:o})=>{if(t.aborted)return null;if("video_message"!==e.type&&"video"!==e.type)return null;const r="video_message"===e.type,n=e[e.type];if(!n.files)return null;const[i,c]=(0,m.A)(n.files),l=n.files?.hls,d=i&&c>=480||i&&!l?i:l||null;if(!d)return null;const _=`${r?"video_messages":"videos"}/${n.owner_id}/${n.id}.mp4`;let u=!1;try{if(d===l)try{await g.default.sendMessage("vkn-b-aath",new URL(d).origin+"/*");const e=await(0,p.A)(d,`${n.owner_id}_${n.id}.mp4`);return o&&(o.progress=(o.progress||0)+1),{name:_,lastModified:n.date?new Date(n.date):a,input:e}}catch(e){u=!0,console.error(e)}if(!i)return null;await g.default.sendMessage("vkn-b-aath",new URL(u?i:d).origin+"/*");const e=await s(u?i:d,{signal:t}),r=await e.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:_,lastModified:n.date?new Date(n.date):a,input:new Blob([r])}}catch(e){console.error(e)}return null},v=async({attach:e,signal:t,lastModified:a,event:o})=>{if(t.aborted)return null;if("audio_message"!==e.type)return null;try{const r=e.audio_message.link_mp3||e.audio_message.link_ogg,n=r===e.audio_message.link_ogg;if(r){const i=await s(r,{signal:t}),c=await i.arrayBuffer();return o&&(o.progress=(o.progress||0)+1),{name:`voices/${e.audio_message.owner_id}/${e.audio_message.id}.${n?"ogg":"mp3"}`,lastModified:a,input:new Blob([c])}}}catch(e){console.error(e)}return null},k=async({attaches:e,lastModified:t,signal:a,event:r,filesNotNull:n=[]})=>{if(!e?.length)return[];const s=[],d=o.default.getValue("downloadChatHistoryAttaches"),u=e=>{s.push(e),r&&(r.progressTotal=(r.progressTotal||0)+1)};for(const o of e)try{switch(o.type){case"photo":d.photos&&u(_({attach:o,lastModified:t,signal:a,event:r}));break;case"sticker":d.stickers&&(u(h({attach:o,lastModified:t,signal:a,event:r})),u(h({attach:o,lastModified:t,signal:a,event:r,isDark:!0})));break;case"audio_message":d.voices&&u(v({attach:o,lastModified:t,signal:a,event:r}));break;case"gift":d.gifts&&u(c({attach:o,lastModified:t,signal:a,event:r}));break;case"wall_reply":case"wall":try{const e=o[o.type];if(Array.isArray(e))for(const o of await k({attaches:e,lastModified:t,signal:a,filesNotNull:n}))o&&u(Promise.resolve(o))}catch(e){console.error(e)}break;case"ugc_sticker":d.stickers&&u(h({attach:o,lastModified:t,signal:a,event:r}));break;case"graffiti":d.graffiti&&u(l({attach:o,lastModified:t,signal:a,event:r}));break;case"video_message":if(d.videoMessages){const e=f({attach:o,lastModified:t,signal:a,event:r});try{await e,u(e)}catch(e){console.error(e)}}break;case"video":if(d.videos){const e=f({attach:o,lastModified:t,signal:a,event:r});try{await e,u(e)}catch(e){console.error(e)}}break;case"doc":d.docs&&u(i({attach:o,lastModified:t,signal:a,event:r}))}if(s.length%8==0)try{await Promise.all(s)}catch(e){console.error(e)}}catch(e){console.error(e)}for(const e of s)try{const t=await e;if(null===t)continue;n.push(t)}catch(e){console.error(e)}return n},y=k},98498:(e,t,a)=>{a.d(t,{A:()=>u});var o=a(49032),r=a(97307),n=a(34747);const s=e=>{e.forEach((e=>{i(e),c(e)}))},i=e=>{e.reply_message&&(e.reply_message.reply_message=void 0)},c=e=>{e.attachments?.filter((e=>"photo"===e.type)).forEach((e=>{const t=(0,n.A)(e.photo.sizes||[]);e.photo.sizes=[t]}))},l=(e,t)=>{const a=JSON.stringify(e,null,t?"\t":void 0);return new Blob([a],{type:"application/json;charset=utf-8"})},d=e=>{const t=(0,r.A)(e,o.Fl);return{chunks:t.map(((e,t)=>({messages:e,name:""+t*o.Fl,index:t,offset:t*o.Fl,count:e.length}))),count:t.length}},_=(e,t,a)=>{const o=5e3;return(0,r.A)(e,o).map(((e,r)=>({input:l(e,t),name:`${r*o}-${r*o+e.length}.json`,lastModified:a})))},u=function({messages:e,singleFile:t,prettyPrint:a,lastModified:o,purpose:r}){return s(e),t?l(e,a):"html"===r?d(e):_(e,a,o)}},36702:(e,t,a)=>{a.d(t,{A:()=>l});var o=a(4255),r=a(97307),n=a(45568),s=a(34747);const i="text/plain",c=(e,t,a=!1)=>{const r="vk.com/"+(o.A.isGroupId(t)?"club"+-t:`id${t}`);let n;return n=o.A.isGroupId(t)?e[t].name||"":a?e[t]?.acc:e[t]?.ins,n?`${n} (${r})`:`${r}`},l=(e,t,a,o=new Date)=>{const l=e.map((e=>{const t=(0,n.A)(1e3*e.date);return e.action?`${t} | ${((e,t)=>{if(!e.action)return null;switch(e.action.type){case"chat_create":return`${c(t,e.from_id)} создал чат "${e.action.text}"`;case"chat_title_update":return`${c(t,e.from_id)} сменил названиие чата:"${e.action.old_text}" -> "${e.action.text}"`;case"chat_invite_user":return`${c(t,e.from_id)} пригласил(а) ${c(t,e.action.member_id,!0)}`;case"chat_kick_user":return e.from_id===e.action.member_id?`${c(t,e.from_id)} вышел из чата`:`${c(t,e.from_id)} исключил(а) ${c(t,e.action.member_id,!0)} из чата`;case"chat_invite_user_by_link":return`${c(t,e.from_id)} вступил в чат по ссылке`;default:return`Действие "${e.action.type}, инициатор: ${c(t,e.from_id)}, цель: ${e.action.member_id?c(t,e.action.member_id):"нет"}"`}})(e,a)} | cmid: ${e.conversation_message_id}`:`${t} | ${c(a,e.from_id)} | cmid: ${e.conversation_message_id}\n`+(e.fwd_messages.length?"[Пересланные сообщения]\n":"")+(e.reply_message?`[Ответ на сообщение: cmid ${e.reply_message.conversation_message_id}]\n`:"")+(e.text||"[Нет текста]")+(e.attachments.length?"\n"+(e=>{const t=[];return e.forEach((e=>{switch(e.type){case"photo":{const a=e?.photo?.sizes||[],o=(0,s.A)(a)?.url;o&&t.push(`[Фото (${o})]`);break}case"video_message":{const a=e.video_message.files?.mp4_480?e.video_message.files?.mp4_480:"Нет ссылки",o=e.video_message.transcript||"Нет транскрипции";t.push(`[Видеосообщение (${a}) (${o})]`);break}case"sticker":t.push("[Стикер]");break;case"audio_message":{const a=e.audio_message.link_mp3||"Нет ссылки",o=e.audio_message.transcript||"Нет транскрипции";t.push(`[Голосовое сообщение (${a}) (${o})]`);break}default:t.push("[Другое вложение]")}})),t.join("\n")})(e.attachments):"")}));return t?new Blob([l.join("\n\n")],{type:i}):(0,r.A)(l,5e3).map(((e,t)=>({input:new Blob([e.join("\n\n")],{type:i}),name:`${5e3*t}-${5e3*t+e.length}.txt`,lastModified:o})))}},57482:(e,t,a)=>{a.a(e,(async(e,o)=>{try{a.d(t,{A:()=>B});var r=a(4255),n=a(39099),s=a(7408),i=a(93819),c=a(88298),l=a(40043),d=a(45161),_=a(42317),u=a(98498),h=a(36702),g=e([c]);let p,m;c=(g.then?(await g)():g)[0];const f=e=>URL.createObjectURL(e),v=async e=>{const{downloadZip:t}=await a.e(1941).then(a.bind(a,71941)),o=await t(e).blob();return URL.createObjectURL(o)},k=async e=>Array.isArray(e)?await v(e):f(e),y=async e=>{const t=new AbortController,{signal:a}=t,o=new Date,r=await i.A,n=await w(e.peerId,e.groupId);let s;await b(n,(()=>t.abort()));const l=await A(e.peerId,e.groupId,a);if(t.signal.aborted)return m(),void p.stopSpeed();if(p.clearIndicator(),"aborted"===l)return;s=l,p.subtitle=r.use("vkcom_processing");let d=await M(s,e,o,a);if(!d)return;const _=await k(d);if(t.signal.aborted)return m(),void p.stopSpeed();var u;await c.N.downloadFileFromLink(_,`${n}.${u=d,void 0!==u.arrayBuffer?e.saveAs:"zip"}`),URL.revokeObjectURL(_),m(),p.stopSpeed()},w=async(e,t)=>{const a=await i.A,{peerName:o}=await(0,n.A)(e,t),s={peerName:o};let c="";return c=r.A.isChatId(e)?a.use("vkcom_download_chat_history_downloading_chat",s):r.A.isGroupId(e)?a.use("vkcom_download_chat_history_downloading_group",s):a.use("vkcom_download_chat_history_downloading_user",s),c},b=async(e,t)=>{const a=await i.A,o=new c.j({icon:"chats",title:e,subtitle:a.use("vkcom_downloading"),onCancel:t}),r=c.N.addEvent(o);p=o,m=r},A=async(e,t,a)=>{p.progress=0;const o=[];for await(const r of(0,l.A)(e,t,a)){!p.progressTotal&&r?.msg_count&&(p.progressTotal=r?.msg_count,p.subtitle="");const e=r?.messages.sort(((e,t)=>e.conversation_message_id&&t.conversation_message_id?e.conversation_message_id-t.conversation_message_id:e.date-t.date))||[];if(e.length>0){const t=JSON.stringify(r);o.push(...e),p.progress+=e.length,p.updateTimeLeft(new Blob([t]).size)}if(a.aborted)return"aborted"}return o},x=async(e,t,a)=>{try{const o=await fetch(e);if(o.ok){const e=await o.blob();a.push({id:t,blob:e})}else console.warn(`[VK Next] Failed to download avatar for ${t}`)}catch(e){console.warn(`[VK Next] Failed to download avatar for ${t}`,e)}},$=async e=>{const t=await i.A;p.subtitle=t.use("vkcom_download_chat_history_downloading_subtitle_avatars");let a=[];const o=[];for(const t in e)e[t].picUrl&&(a.push(x(e[t].picUrl,t,o)),20===a.length&&(await Promise.all(a),a=[]));return await Promise.all(a),o},M=async(e,t,a,o)=>"txt"===t.saveAs?await P(e,t.singleFile):"json"===t.saveAs?(0,u.A)({messages:e,singleFile:t.singleFile,prettyPrint:t.prettyPrint,lastModified:a}):await C(e,a,o),j=e=>{const t=new Set,a=new Set,o=e=>{e&&(r.A.isGroupId(e)?a.add(e):t.add(e))};return e.forEach((e=>{o(e.from_id),o(e.reply_message?.from_id),o(e.action?.member_id)})),{userIds:[...t],groupIds:[...a]}},P=async(e,t)=>{const{userIds:a,groupIds:o}=j(e),r=await(0,d.m)(a,o);return(0,h.A)(e,t,r)},S=async({message:e,lastModified:t,signal:a,event:o})=>{const r=[];try{for(const n of await(0,_.A)({attaches:e.attachments,lastModified:t,signal:a,event:o}))try{r.push(n)}catch(e){console.error(e)}if(Array.isArray(e.fwd_messages))for(const n of e.fwd_messages)try{const e=await S({message:n,lastModified:t,signal:a,event:o});r.push(...e)}catch(e){console.error(e)}}catch(e){console.error(e)}return r},C=async(e,t,a)=>{let o=(0,u.A)({messages:e,singleFile:!1,prettyPrint:!1,lastModified:t,purpose:"html"});const r=await fetch(await(0,s.A)("chatHistory.html")).then((e=>e.text())),n=[],{userIds:i,groupIds:c}=j(e),l=await(0,d.b)(i,c);for(const e of o.chunks){const s=Array.from(new Set(e.messages.map((e=>[e.from_id,e.reply_message?.from_id,e.action?.member_id])).flatMap((e=>e)).filter((e=>e)))),i={};for(const e of s)i[e]=l[e];const c=`<div id="data" data-messages="${encodeURIComponent(JSON.stringify(e.messages))}" data-peernames="${encodeURIComponent(JSON.stringify(i))}" data-curpage="${e.index+1}" data-pagescount="${o.count}"></div>`,d=r.replace("{marker}",c),_=new Blob([d],{type:"text/html"});n.push({input:_,lastModified:t,name:`index${e.name}.html`});const u=new Set;for(const o of e.messages)try{for(const e of await S({message:o,lastModified:t,signal:a,event:p}))u.has(e.name)||(u.add(e.name),n.push(e))}catch(e){console.error(e)}}const _=new AbortController;p.onCancel=_.abort;const h=await $(l);for(const e of h)n.push({input:e.blob,lastModified:t,name:`avatars/${e.id}.jpg`});const g=await fetch(await(0,s.A)("chatHistoryFiles.json")).then((e=>e.json()));for(const e of g){const a=await(0,s.A)(e),o=await fetch(a).then((e=>e.blob()));n.push({input:o,lastModified:t,name:e})}return n},B=y;o()}catch(e){o(e)}}))},34747:(e,t,a)=>{a.d(t,{A:()=>o});const o=e=>e.reduce(((e,t)=>{const a=t.width*t.height;return!e||a>e.width*e.height?t:e}))},99761:(e,t,a)=>{a.d(t,{A:()=>o});const o=e=>{const t=Object.keys(e).filter((e=>e.startsWith("mp4_")));t.sort(((e,t)=>{const a=parseInt(e.split("_")[1]);return parseInt(t.split("_")[1])-a}));for(const a of t)if(e[a])return[e[a],Number(a.split("_")[1])];return[null,null]}},56445:(e,t,a)=>{a.a(e,(async(e,o)=>{try{a.d(t,{A:()=>l});var r=a(74848),n=a(39107),s=a(87675),i=a(79705),c=e([s]);s=(c.then?(await c)():c)[0];const l=()=>{const e=(0,s.A)(),[t,a]=(0,i.A)("downloadChatHistoryAttaches");return(0,r.jsxs)(n.YJl,{header:(0,r.jsx)(n.Y9Y,{children:e.use("vkcom_download_chat_history_attaches_title")}),separator:"hide",mode:"plain",children:[(0,r.jsx)(n.Sc0,{checked:Boolean(t.photos),onChange:({target:e})=>a({...t,photos:e.checked}),children:e.use("vkcom_download_chat_history_attaches_photos")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.videos),onChange:({target:e})=>a({...t,videos:e.checked}),children:e.use("vkcom_download_chat_history_attaches_videos")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.voices),onChange:({target:e})=>a({...t,voices:e.checked}),children:e.use("vkcom_download_chat_history_attaches_voices")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.videoMessages),onChange:({target:e})=>a({...t,videoMessages:e.checked}),children:e.use("vkcom_download_chat_history_attaches_video_messages")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.stickers),onChange:({target:e})=>a({...t,stickers:e.checked}),children:e.use("vkcom_download_chat_history_attaches_stickers")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.gifts),onChange:({target:e})=>a({...t,gifts:e.checked}),children:e.use("vkcom_download_chat_history_attaches_gifts")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.graffiti),onChange:({target:e})=>a({...t,graffiti:e.checked}),children:e.use("vkcom_download_chat_history_attaches_graffiti")}),(0,r.jsx)(n.Sc0,{checked:Boolean(t.docs),onChange:({target:e})=>a({...t,docs:e.checked}),children:e.use("vkcom_download_chat_history_attaches_docs")})]})};o()}catch(e){o(e)}}))},36076:(e,t,a)=>{a.a(e,(async(e,o)=>{try{a.r(t),a.d(t,{default:()=>f});var r=a(74848),n=a(39107),s=a(2290),i=a(95974),c=a(85560),l=a(33911),d=a(17100),_=a(57482),u=a(49962),h=a(87675),g=a(79705),p=a(56445),m=e([l,_,h,p]);[l,_,h,p]=m.then?(await m)():m;const f=({peerId:e,groupId:t})=>{const a=(0,h.A)(),[o,m]=(0,g.A)("downloadChatHistoryFormat"),[f,v]=(0,g.A)("downloadChatHistorySplit"),[k,y]=(0,g.A)("downloadChatHistoryPrettyPrint"),{closeModal:w}=(0,d.Hb)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.tUM,{mode:"accent",children:(0,r.jsxs)(n.ox2,{arrowSize:"m",children:[(0,r.jsx)(n.ORv,{selected:"txt"===o,onClick:()=>m("txt"),children:"TXT"}),(0,r.jsx)(n.ORv,{selected:"json"===o,onClick:()=>m("json"),children:"JSON"}),(0,r.jsx)(n.ORv,{selected:"html"===o,onClick:()=>m("html"),after:(0,r.jsxs)(l.A,{children:[(0,r.jsx)(l.A.PrimeDeluxe,{placement:"top"}),(0,r.jsx)(l.A.Beta,{placement:"right"})]}),children:"HTML"})]})}),(0,r.jsx)(n.YJl,{separator:"hide",children:(0,r.jsx)(n.iau,{style:{paddingTop:0,paddingBottom:0},children:(0,r.jsx)(n.lZ$,{extraSubtitle:a.use(`vkcom_download_chat_history_${o}_desc`)})})}),"json"===o&&(0,r.jsx)(n.YJl,{separator:"hide",children:(0,r.jsx)(n.T6P,{after:(0,r.jsx)(i.A,{}),Component:"label",onClick:()=>y(!k),children:a.use("vkcom_download_chat_history_pretty_print")})}),"html"===o?(0,r.jsx)(p.A,{}):(0,r.jsxs)(n.YJl,{header:(0,r.jsx)(n.Y9Y,{children:a.use("vkcom_download_chat_history_split_title")}),separator:"hide",children:[(0,r.jsx)(n.sxL,{name:"split",value:"true",checked:f,onChange:e=>{e.target.checked&&!f&&v(!0)},children:a.use("vkcom_download_chat_history_split")}),(0,r.jsx)(n.sxL,{name:"split",value:"false",checked:!f,onChange:e=>{e.target.checked&&f&&v(!1)},children:a.use("vkcom_download_chat_history_single_file")})]}),(0,r.jsx)(n.iau,{className:s.A.ButtonWrapper,children:(0,r.jsx)(n.$nd,{onClick:async()=>{"html"!==o||await(0,c.default)()?(w(),await(0,_.A)({peerId:e,groupId:t,saveAs:o,singleFile:!f,prettyPrint:k})):await(0,u.A)()},children:a.use("global_download")})})]})};o()}catch(e){o(e)}}))},49962:(e,t,a)=>{a.d(t,{A:()=>r});var o=a(81192);const r=()=>(0,o.default)("#/deluxe")},35584:(e,t,a)=>{a.d(t,{A:()=>o});const o=(e,t,a=null)=>{if(!Array.isArray(e)||0===e.length)return null;const o=[...e].sort(((e,t)=>e.width<t.width?-1:e.width>t.width?1:e.height<t.height?-1:e.height>t.height?1:0)),r=o.filter((e=>e.width>=t));if(0===r.length)return o[o.length-1];if(!a)return r[0];for(let e=0;e<r.length;e++){const t=r[e];if(t.height>=a)return t}const n=r.sort(((e,t)=>t.height-e.height));return n[n.length-1]}},95974:(e,t,a)=>{a.d(t,{A:()=>s});var o=a(74848),r=a(39107);const n="_ME21DoLEVJUlnQU",s=({className:e,...t})=>(0,o.jsx)(r.V9m,{value:r.ODD.ANDROID,children:(0,o.jsx)(r.dOG,{className:(0,r.xWm)(n,e),...t})})},49032:(e,t,a)=>{a.d(t,{Fl:()=>s,XZ:()=>n,hj:()=>r,lz:()=>o});const o=/(^|\/)al_im\.php|(^|\/)im(\?|$)|(^|\/)gim\d+|\/write-?\d+/,r=/(^|\/)al_im\.php|(^|\/)im(\?|$)|\/write-?\d+|\/im\/.*/,n={"--accent":"--vkui--color_icon_accent","--background_content":"--vkui--color_background_content","--background_highlighted":"--vkui--color_transparent--active","--background_hover":"--vkui--color_transparent--hover","--background_light":"--vkui--color_background_tertiary","--background_page":"--vkui--color_background","--background_suggestions":"--vkui--color_background_modal","--button_commerce_background":"--vkui--color_text_positive","--button_secondary_background":"--vkui--color_background_secondary_alpha","--button_secondary_destructive_foreground":"--vkui--color_background_negative","--content_tint_background":"--vkui--color_background_secondary","--content_warning_background":"--vkui--color_background_warning","--counter_prominent_text":"--vkui--color_text_contrast","--destructive":"--vkui--color_text_negative","--dynamic_gray":"--vkui--color_accent_gray","--dynamic_green":"--vkui--color_accent_green","--dynamic_orange":"--vkui--color_accent_orange","--dynamic_purple":"--vkui--color_accent_purple","--dynamic_red":"--vkui--color_accent_red","--dynamic_violet":"--vkui--color_accent_violet","--dynamic_blue":"--vkui--color_accent_blue","--dynamic_raspberry_pink":"--vkui--color_accent_raspberry_pink","--field_background":"--vkui--color_field_background","--field_border":"--vkui--color_field_border_alpha","--field_error_background":"--vkui--color_background_negative_tint","--field_error_border":"--vkui--color_stroke_negative","--field_valid_border":"--vkui--color_stroke_positive","--header_background":"--vkui--color_header_background","--header_tint_alternate":"--vkui--color_icon_accent_themed","--icon_alpha_placeholder":"--vkui--color_icon_contrast","--icon_medium_alpha":"--vkui--color_icon_medium_alpha","--icon_medium":"--vkui--color_icon_medium","--icon_secondary_alpha":"--vkui--color_icon_secondary_alpha","--icon_secondary":"--vkui--color_icon_secondary","--icon_tertiary_alpha":"--vkui--color_icon_tertiary_alpha","--icon_tertiary":"--vkui--color_icon_tertiary","--image_border":"--vkui--color_image_border_alpha","--input_background":"--vkui--color_write_bar_input_background","--input_border":"--vkui--color_write_bar_input_border_alpha","--link_alternate":"--vkui--color_text_link_themed","--loader_track_fill":"--vkui--color_track_background","--loader_track_value_fill":"--vkui--color_track_buffer","--placeholder_icon_background_opaque":"--vkui--color_image_placeholder_alpha","--placeholder_icon_background":"--vkui--color_image_placeholder","--search_bar_field_background":"--vkui--color_search_field_background","--segmented_control_bar_background":"--vkui--color_segmented_control","--separator_alpha":"--vkui--color_separator_primary_alpha","--separator_alternate":"--vkui--color_separator_secondary","--separator_common":"--vkui--color_separator_primary","--skeleton_foreground_from":"--vkui--color_skeleton_from","--skeleton_foreground_to":"--vkui--color_skeleton_to","--text_link":"--vkui--color_text_link","--text_muted":"--vkui--color_text_muted","--text_primary":"--vkui--color_text_primary","--text_secondary":"--vkui--color_text_secondary","--text_subhead":"--vkui--color_text_subhead","--text_tertiary":"--vkui--color_text_tertiary","--writebar_icon":"--vkui--color_write_bar_icon","--gray_400":"--vkui--color_text_secondary","--gray_500":"--vkui--color_text_subhead","--gray_600":"--vkui--color_text_subhead","--gray_900":"--vkui--color_text_muted","--im_forward_line_tint":"--vkui--vkontakte_color_im_forward_line_alpha","--im_bubble_incoming":"--vkui--vkontakte_color_im_bubble_incoming","--im_bubble_incoming_alternate":"--vkui--vkontakte_color_im_bubble_incoming_alternate","--im_bubble_incoming_expiring":"--vkui--vkontakte_color_im_bubble_incoming_expiring","--im_bubble_border_alternate_highlighted":"--vkui--vkontakte_color_im_bubble_border_alternate_highlighted_alpha","--modal_card_background":"--vkui--color_background_modal","--im_bubble_outgoing":"--vkui--vkontakte_color_im_bubble_outgoing"},s=1e3},97307:(e,t,a)=>{function o(e,t){const a=[];for(let o=0;o<e.length;o+=t){const r=e.slice(o,o+t);a.push(r)}return a}a.d(t,{A:()=>o})},45568:(e,t,a)=>{a.d(t,{A:()=>o});const o=(e,t=!0,a=!1)=>{const o=new Date(e),r=e=>String(e).padStart(2,"0"),n=r(o.getDate()),s=r(o.getMonth()+1);let i=r(o.getFullYear());const c=r(o.getHours()),l=r(o.getMinutes()),d=r(o.getSeconds());return a&&(i=i.substring(2)),t?`${n}.${s}.${i}, ${c}:${l}:${d}`:`${n}.${s}.${i}`}},52352:(e,t,a)=>{a.d(t,{A:()=>o});const o=(e,t,a)=>e<t?0:e>a?100:(e-t)/(a-t)*100},70459:(e,t,a)=>{a.d(t,{A:()=>o});const o={AudioPageMainTabBtn:"XYzoAKWs2KhH02Ye",AudioArtistHeaderActions:"v8VBorduCtZgTyyi",VideoPlayerDownloadIcon:"eaSw45y_1KLlo4Gw",SecondaryAttachment__afterItem:"RZ6NWD1WvjAOxG2Y",DownloadManagerPopup:"o9vy1XhnZrkvykUb",VideoPlayerHlsWarning__tooltip:"P9MhdlrtilEQt7Am",VideoPlayerHlsWarning__text:"Xq2PVks6OK6Z74Al",AudioPlaylistSnippet__actions:"FawmW4_Zd1R1BI1E",AudioPlaylistSnippet__actionButton:"ZPr5mXzL52VUPaRe",ActionButton__icon:"_5bFyslOmNjqqP7y",ActionButton__text:"o7YAH98fI9KVToa5",AudioPlayerUserControlsContainer__userButton:"e47qq1XqMPp6oTp7",AudioPlayerPlaybackButton:"wqb5e3cgYZFgHCc1",AudioRowReact__button:"q7d6KTdMjs6HYpKm"}},2290:(e,t,a)=>{a.d(t,{A:()=>o});const o={JsonFormatSelectedValue:"Ek9qRnOxfJ94NbYl",JsonFormatSelectedValue__Name:"dTthfrcJcIo7MrAY",JsonFormatSelectedValue__Icon:"p8Mj7fJlgg49tbVw",ButtonWrapper:"t_vspRturOjxpvZq"}},55073:(e,t,a)=>{a.d(t,{c:()=>o});const o=()=>{let e,t;return{promise:new Promise(((a,o)=>{e=a,t=o})),resolve:e,reject:t}}},35277:(e,t,a)=>{a.d(t,{_:()=>l});var o=a(55073);const r=e=>new Promise((t=>setTimeout(t,e)));let n,s=null,i=0;const c=async()=>{n||(n=(async()=>{if(await r(6e4),!s)return;const e=await s;e&&(0===i&&await r(1e4),0===i&&(s=null,e.remove()))})(),n.finally((()=>{n=null})))},l=async({onProgress:e,type:t,iframeURL:r="https://vknext.net/ffmpeg",...n})=>{const{promise:l,reject:d,resolve:_}=(0,o.c)(),u="request-"+Math.random().toString(36).substr(2,9),h=await(e=>{if(s)return s;const{promise:t,resolve:a,reject:r}=(0,o.c)();s=t;const n=document.querySelector(`iframe[src="${e}"]`);if(n)return a(n),t;const i=document.createElement("iframe");return i.src=e,i.style.setProperty("display","none","important"),i.onload=()=>a(i),i.onerror=r,(document.body||document.documentElement).appendChild(i),t})(r),{Bridge:g}=await a.e(2692).then(a.bind(a,42692)),p=new g(h.contentWindow,{prefix:"vknext-net-bridge"});return i++,e&&p.on("progress",(t=>{const a=t;a?.requestId===u&&e(a.progress,a.total)})),p.on("error",(e=>{const t=e;t?.requestId===u&&(d(t?.error||"unknown error"),p.destroy(),i--,c())})),p.on("response",(e=>{const t=e;t?.requestId===u&&(_(t.response),p.destroy(),i--,c())})),p.on("getBlob",(e=>{const t=e;if(t?.requestId===u)return fetch(t.url).then((e=>e.blob()))})),p.post(t,{...n,requestId:u}),l}}}]);