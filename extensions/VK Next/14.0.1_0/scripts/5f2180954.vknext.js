"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[2497],{36843:(t,e,o)=>{o.d(e,{A:()=>i});var n=o(65578);const i=()=>(0,n.A)("AudioUtils")},25632:(t,e,o)=>{o.d(e,{A:()=>h});var n=o(82050),i=o(95728),a=o(60962),r=o(14943),s=o(95684),c=o(67992),l=o(38729),d=o(78105),u=o(88213);const p=new c.A,A=(0,l.NS)(),f='[class*="AudioRow__root"]',w=async t=>{if(await(0,s.A)(),t.attributes.getNamedItem("disabled"))return;const e=(t=>{const{props:e}=(0,i.A)(t);if(e?.children?.props?.audio?.apiAudio)return e.children.props.audio.apiAudio;if(t.parentElement){const{props:e}=(0,i.A)(t.parentElement);if(e.children?.props?.audio?.apiAudio)return e.children.props.audio.apiAudio}return null})(t);for(const o of p.listeners)o(t,e)},m=async(t=0)=>{if(document.querySelector('.vkui__root .vkuiFlex [class*="Skeleton__skeleton"]'))return await(0,n.A)(1e3),m(t+1);await(0,s.A)(),await(0,r.A)();const e=document.querySelectorAll(f);for(const t of e)await(0,s.A)(),await w(t);await(async()=>{for(const t of document.querySelectorAll('[class*="AudioListItems__root--"] > div'))t[A]||(t[A]=new MutationObserver((t=>{for(const e of t)if("childList"===e.type)for(const t of e.addedNodes)if(t instanceof HTMLElement)if(t.matches(f))w(t);else for(const e of t.querySelectorAll(f))w(e)})),t[A].observe(t,{childList:!0}))})()};let _=!1;const h=t=>{const e=p.addListener(t);return(0,a.A)(m),_||(_=!0,(0,d.A)((()=>m())),(0,u.A)((()=>m()))),e}},78105:(t,e,o)=>{o.d(e,{A:()=>p});var n=o(82050),i=o(60962),a=o(14943),r=o(67992),s=o(4107);const c=new r.A,l=t=>t.replace("audio_playlist","").replace("/","_");let d=!1;const u=async()=>{if(d)return;d=!0;const t=await(0,s.A)();t.onLocationChange((async()=>{const e=t.objLoc.z;e&&e.startsWith("audio_playlist")&&(await(0,n.A)(1e3),await(0,a.A)(),(t=>{const e=l(t);for(const t of c.listeners)t(e)})(e))}))},p=t=>{const e=c.addListener(t);return(0,i.A)((()=>{const e=new URLSearchParams(window.location.search).get("z");e&&e.startsWith("audio_playlist")&&requestAnimationFrame((()=>t(l(e)))),u()})),e}},88213:(t,e,o)=>{o.d(e,{A:()=>u});var n=o(82050),i=o(60962),a=o(14943),r=o(67992),s=o(4107);const c=new r.A;let l=!1;const d=async()=>{if(l)return;l=!0;(await(0,s.A)()).onLocationChange((async t=>{(t.startsWith("music/album")||t.startsWith("music/playlist"))&&(await(0,n.A)(1e3),await(0,a.A)(),(()=>{for(const t of c.listeners)t()})())}))},u=t=>{const e=c.addListener(t);return(0,i.A)((()=>{(window.location.pathname.startsWith("/music/album")||window.location.pathname.startsWith("/music/playlist"))&&requestAnimationFrame((()=>t())),d()})),e}},82497:(t,e,o)=>{o.r(e);var n=o(74848),i=o(98570),a=o(36843),r=o(25632),s=o(3068);let c=!1;(async()=>{c||(c=!0,(0,i.A)()?.vms_installed||((0,a.A)().then((t=>{if((0,i.A)()?.vms_installed)return;if(!t.onRowOver)return;if(t._down_inj)return;t._down_inj=!0;const e=t.onRowOver;t.onRowOver=function(...t){try{(async t=>{if((0,i.A)()?.vms_installed)return;const e=t.querySelector(".audio_row__actions");if(!e)return;if(e.vkn_down_inj)return;e.vkn_down_inj=!0;const a=t.dataset.audio;if(!a)return;const r=AudioUtils.audioTupleToAudioObject(JSON.parse(a));if(!r)return;if(r?.restrictionStatus||t.classList.contains("audio_row__deleted"))return;const c=document.createElement("div"),{default:l}=await Promise.all([o.e(2551),o.e(7983),o.e(2020),o.e(3543),o.e(9381),o.e(4412),o.e(1434),o.e(2760)]).then(o.bind(o,50150)),{unmount:d}=await(0,s.A)({root:c,content:(0,n.jsx)(l,{type:"audio_row",audioObject:r,tooltipProps:{placement:"top",appearance:"black"}}),disableAppRoot:!0,disableConfig:!0,disableParentTransformForPositionFixedElements:!0});t.addEventListener("mouseleave",(()=>{d(),e.vkn_down_inj=!1}),{once:!0}),e.prepend(c)})(t[0]).catch(console.error)}catch(t){console.error(t)}return Reflect.apply(e,this,t)}})),(0,r.A)((async(t,e)=>{if(!e)return void console.error("no audio",{audioRow:t});if((0,i.A)()?.vms_installed)return;const a=t.querySelector('[class*="AudioRow__actions--"]');if(!a)return;if(a.vkn_down_inj)return;a.vkn_down_inj=!0;const r=a.querySelector(".vkuiButtonGroup"),c=document.createElement("div");(r||a).prepend(c);const{default:l}=await Promise.all([o.e(2551),o.e(7983),o.e(2020),o.e(3543),o.e(9381),o.e(4412),o.e(1434),o.e(2760)]).then(o.bind(o,50150));await(0,s.A)({root:c,content:(0,n.jsx)(l,{type:"audio_row_react",audioObject:e,tooltipProps:{placement:"bottom"}}),disableAppRoot:!0,disableConfig:!0,disableParentTransformForPositionFixedElements:!0})}))))})().catch(console.error)}}]);