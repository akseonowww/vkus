"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[5667,7746],{64556:(e,t,a)=>{a.d(t,{A:()=>o});var r=a(99381),n=a(63898);const s=["getMe","getFile","getStickerSet"];const o=class{token;constructor(e){this.token=e;for(const e of s)this[e]=new Proxy(r.A,{get:(t,a)=>t=>this.call(`${e}.${a}`,t),apply:(t,a,r)=>a.call(e,r[0])})}isValidToken(){if(!this.token)return!1;const e=this.token.split(":");return!(2!==e.length||e[0].length<4||35!==e[1].length)}async call(e,t){const a=await(0,n.A)(`https://api.telegram.org/bot${this.token}/${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)}),r=await a.json();return r.ok,r}getFileUrl(e){return`https://api.telegram.org/file/bot${this.token}/${e}`}}},37770:(e,t,a)=>{a.d(t,{A:()=>c});var r=a(63898),n=a(98570),s=a(64556);const o=async()=>{const e=(0,n.A)().browserApi;if(e?.storage)return e.storage;const{storage:t}=await a.e(6815).then(a.t.bind(a,96815,23));return t},i=async({file_id:e,emoji:t},a)=>{if(!e)return null;const n=await a.getFile({file_id:e});if(!n.ok)return null;const s=await(0,r.A)(a.getFileUrl(n.result.file_path)),o=await s.arrayBuffer();return{file_id:e,emoji:t,data:btoa([...new Uint8Array(o)].map((e=>String.fromCharCode(e))).join(""))}},c=async({name:e,title:t,thumb:a,stickers:r})=>{const n=await o(),c=new s.A(await(async()=>{const e=await o();return((await e.local.get("tokens")).tokens||{})[0].tgToken})()),l=(await Promise.all(r.map((e=>i(e,c))))).filter((e=>null!==e)),d=(await n.local.get(["telegramStickers"])).telegramStickers||[],g=a?.file_id||r[0].thumb?.file_id,w=await i({file_id:g},c),h={name:e,title:t,thumb:w?.data,stickers:l,file_id:g};let u=!1;for(let t=0;t<d.length;t++)if(d[t].name==e){d[t]=h,u=!0;break}return u||d.unshift(h),await n.local.set({telegramStickers:d}),{ok:!0,isReplaced:u}}},65667:(e,t,a)=>{a.a(e,(async(e,r)=>{try{a.r(t),a.d(t,{default:()=>h});var n=a(37770),s=a(37746),o=a(36008),i=a(7408),c=a(47405);const e=await o.default.sendMessage("vkn-b-gm"),l={vknext:()=>Promise.resolve().then(a.bind(a,43024)),Themes:()=>a.e(5633).then(a.bind(a,45633)),telegramStickers:()=>a.e(4144).then(a.bind(a,84144)),tokens:()=>a.e(6289).then(a.bind(a,96289)),StorageMessages:()=>a.e(1691).then(a.bind(a,31691)),VKNDeletedMessages:()=>a.e(367).then(a.bind(a,40367)),VKNExpiredMessages:()=>a.e(1243).then(a.bind(a,21243)),VKN_templates:()=>a.e(4352).then(a.bind(a,64352)),audioMessages:()=>a.e(2827).then(a.bind(a,22827)),spyning:()=>a.e(4765).then(a.bind(a,24765)),wallpaper:()=>Promise.resolve().then(a.bind(a,76763)),chatStats:()=>a.e(634).then(a.bind(a,10634)),localRename:()=>a.e(7302).then(a.bind(a,97302))},d={},g=async e=>{if(l[e]){const{default:t}=await l[e]();return t}if(d[e])return d[e];const{default:t}=await Promise.resolve().then(a.bind(a,53778));return d[e]=new t(e,{lifetime:18e5}),d[e]},w={async get(e){const t={};for(const a of Array.isArray(e)?e:[e])try{const e=await g(a);t[a]=await e.getStorage()}catch(e){console.error("[browserApi] storage.get error",e)}return t},async getAll(){const e={};for(const t of Object.keys(l).concat(Object.keys(d)))try{const a=await g(t);e[t]=await a.getStorage()}catch(e){console.error(`[browserApi] storage.getAll("${t}") error`,e)}return e},async set(e){for(const t of Object.keys(e))try{const a=await g(t);await a.saveStorage(e[t])}catch(t){console.error("[browserApi] storage.set error",t,{items:e})}},async remove(e){for(const t of Array.isArray(e)?e:[e])try{const e=await g(t),a=await e.getStorage();if(!a)continue;Array.isArray(a)?await e.saveStorage([]):await e.saveStorage({})}catch(e){console.error("[browserApi] storage.get error",e)}},async clear(){for(const e of Object.keys(l).concat(Object.keys(d)))try{const t=await g(e),a=await t.getStorage();if(!a)continue;Array.isArray(a)?await t.saveStorage([]):await t.saveStorage({})}catch(e){console.error("[browserApi] storage.clear error",e)}},onChanged:{addListener(e,t){const a=g(e);let r=null;return a.then((e=>{const{remove:a}=e.addListener(((e,n)=>{t({oldValue:e,newValue:n}),r=a}))})),()=>{a.then((()=>{r&&r()}))}}}},h={getManifest:()=>({version:e.version,id:e.id,installType:"normal"}),getRuntimeURL:i.A,async sendMessage(e){const t=e?.type;if("sw_gcf"===t)return await(0,c.A)();if("sw_reloadVKCOM"===t)return await o.default.sendMessage("vkn-b-rvk");if("sw_d_tgs"===t)return await(0,n.A)(e);throw new Error(`Unknown message ${t}`)},requestUpdateCheck:async()=>await o.default.sendMessage("vkn-b-ruc"),async createTab({url:e}){window.open(e,"_blank")},async downloadFile({url:e,filename:t}){await(0,s.default)(e,t)},storage:{local:w,sync:w}};r()}catch(e){r(e)}}),1)},63898:(e,t,a)=>{a.d(t,{A:()=>r});const r=async(e,t)=>await fetch(e,t)},37746:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});const r=e=>{try{e.dispatchEvent(new MouseEvent("click"))}catch(t){const a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}},n=async(e,t="download")=>{const a=document.createElement("a");a.download=t,a.rel="noopener",(globalThis?.chrome?.runtime?.id||globalThis?.browser?.runtime?.id)&&(a.target="_blank"),"string"==typeof e?(a.href=e,a.origin!==location.origin?await(async e=>{try{const t=await globalThis.fetch(e,{method:"HEAD"});return t.status>=200&&t.status<=299}catch(e){console.error(e)}return!1})(a.href)?await(async(e,t)=>{try{const a=await globalThis.fetch(e,{method:"GET"}),r=await a.blob();await n(r,t)}catch(e){console.error(e)}})(e,t):(a.target="_blank",r(a)):r(a)):(a.href=URL.createObjectURL(e),setTimeout((()=>{URL.revokeObjectURL(a.href)}),4e4),setTimeout((()=>{r(a)}),0))},s=n}}]);