"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[4619],{93494:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(43883);const i=new Set;let r=!1;const s=e=>(i.add(e),(async()=>{if(r)return;r=!0;const e=await(0,a.A)(),t=e.api;e.api=function(...n){let a=!1;for(const e of i)try{const t=e(n);!0===t?a=!0:!t||t instanceof Promise||(n=t)}catch(e){console.error(e)}return a?new Promise((()=>{})):Reflect.apply(t,e,n)}})(),()=>i.delete(e))},64619:(e,t,n)=>{n.a(e,(async(e,a)=>{try{n.r(t);var i=n(57580),r=n(5305),s=n(93494),o=n(11860),c=n(37573),d=n(43024),l=e([i]);i=(l.then?(await l)():l)[0];let u=null,p=null;const g=()=>{u||(u=(0,r.A)((e=>{if(d.default.getValue("noonline")){const[t,n]=e;if("al_im.php"===t){if("a_mark_read"===n.act&&n.ids?.length)return(0,o.A)(n.peer||0,n.gid||0)||window.vkApi.api("execute",{code:`var m=${n.ids[0]},g=${n.gid};m=API.messages.getById({message_ids:m,group_id:g}).items[0];return API.messages.markAsRead({peer_id:m.peer_id,up_to_cmid:m.conversation_message_id,mark_conversation_as_read:1,group_id:g});`}),!0;if("a_activity"===n.act)return(0,c.A)(n.peer||0,n.gid||0)||window.vkApi.api("messages.setActivity",{peer_id:n.peer,group_id:n.gid,type:n.type}),!0}else if("update_online"===n?.act)return!0}return e})))},_=()=>{p||(p=(0,s.A)((e=>{const t=e[0];return"account.setOnline"===t&&(e[0]="account.setOffline"),"apps.updateOnline"===t||e})))};0,d.default.onInited((()=>{d.default.getValue("noonline")&&(g(),_())})),d.default.addChangeKeyListener("noonline",((e,t)=>{t?(g(),_()):(u&&(u(),u=null),p&&(p(),p=null))})),a()}catch(e){a(e)}}))}}]);