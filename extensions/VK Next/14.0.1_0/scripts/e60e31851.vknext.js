"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[6410,122],{14694:(t,e,n)=>{n.d(e,{A:()=>s});const s=()=>"https://api.vknext.net"},88400:(t,e,n)=>{n.d(e,{A:()=>s});const s=async t=>{const e=await t.json(),s=t.headers.get("Content-Type");if(s&&s.startsWith("application/x-vknextpack")&&e)try{const t=new Uint8Array(Object.values(e)),{decode:s}=await n.e(7802).then(n.bind(n,77802));return s(t)}catch(t){console.error(t)}return e}},46140:(t,e,n)=>{n.d(e,{A:()=>l});var s=n(22440),r=n(82050),a=n(98570),i=n(75412);const o=(0,s.A)(),c=async t=>{const e=(0,a.A)().browserApi;if(e){return(await e.storage.local.get(t))[t]}if(o?.localStorage)return o.localStorage.getItem(t);const{storage:s}=await n.e(6815).then(n.t.bind(n,96815,23));return(await s.local.get(t))[t]},d=async(t,e)=>{const s=(0,a.A)().browserApi;if(s)return void await s.storage.local.set({[t]:e});if(o?.localStorage)return void o.localStorage.setItem(t,e);const{storage:r}=await n.e(6815).then(n.t.bind(n,96815,23));await r.local.set({[t]:e})},u=async(t,e)=>{const n=`vknLP${t}`,s=`vknLPD${t}`,a=await c(n),o=await c(s);if(a&&Date.now()-(parseInt(o||"")||0)<216e5)return a?.response||a;try{const{view_url:a}=await e.apps.getEmbeddedUrl({app_id:await(0,i.A)(),v:"5.123"});if(!a)return await(0,r.A)(5e3),u(t,e);const o=a.split("?")[1].split("#")[0];return await d(n,o),await d(s,Date.now().toString()),o}catch(n){return console.error(n),await(0,r.A)(1500),u(t,e)}},l=u},47961:(t,e,n)=>{n.d(e,{A:()=>r});var s=n(387);const r=async(t,e,n)=>{try{delete Uint8Array.prototype.toJSON}catch(t){console.error(t)}const r=(0,s.A)(),a=((t,e)=>{const n=t.toString().length,s=new Uint8Array(16);for(let r=0;r<e.length;r++){const a=e.charCodeAt(r)*t/n;s[r%16]^=255&a}return s})(t,e),i=await(t=>crypto.subtle.importKey("raw",t,{name:"AES-CBC"},!1,["encrypt"]))(a),o={version:await n.getVersion(),udGltZS5p:await n.getRuntimeId(),cGlkb3I:t,fdhjiD:"ba05681e16c97c31e1be20e84f250d55",v9Cdi3sD:r},c=JSON.stringify(o),d=(new TextEncoder).encode(c),u={name:"AES-CBC",iv:crypto.getRandomValues(new Uint8Array(16))},l=await crypto.subtle.encrypt(u,i,d),p=new Uint8Array(u.iv.length+l.byteLength);return p.set(new Uint8Array(u.iv),0),p.set(new Uint8Array(l),u.iv.length),p}},75412:(t,e,n)=>{n.d(e,{A:()=>r});var s=n(14694);const r=async()=>{try{const t=await fetch(`${(0,s.A)()}/internal.getAuthAppId`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Api-Version":"3"}});if(t.ok)return parseInt(await t.text())}catch(t){console.error("[VK Next/getAuthAppId] Error:",t)}return 8194076}},24370:(t,e,n)=>{n.d(e,{Q:()=>c});var s=n(82050),r=n(14694),a=n(88400),i=n(46140),o=n(47961);class c{vkapi;vkAgents;userId;constructor({api:t}){this.vkapi=t,this.userId=0,this.vkAgents=new Map}async call(t,e,n){const i=await this.getVkAgent(),o={...e,"vknext-agent":await this.gvkna()};let c=0;const d=`${(0,r.A)()}/${t}`,u=JSON.stringify(o),l={Accept:"application/json","Content-Type":"application/json","VK-Agent":i,"VK-User-ID":`${this.userId||0}`,"9603a224b40d7b67210b78f2e390d00f":"ba05681e16c97c31e1be20e84f250d55","Api-Version":"3",...n};let p=new Response(JSON.stringify({error_code:408}),{status:408});for(;c<3;){const t=new AbortController,e=setTimeout((()=>t.abort()),15e3);try{if(p=await fetch(d,{body:u,method:"POST",headers:l,signal:t.signal}),502!==p.status)return(0,a.A)(p);{await(0,s.A)(2e3);const t=await p.text();if(!t.toLowerCase().includes("cloudflare"))return(0,a.A)(p);await(0,s.A)(c)}}catch(t){console.error(t),await(0,s.A)(2e3)}clearTimeout(e),c++}return(0,a.A)(p)}async getVkAgent(){if(0===this.userId&&(this.userId=await this.getUserId()),this.vkAgents.has(this.userId))return this.vkAgents.get(this.userId);return(0,i.A)(this.userId,this.vkapi)}async gvkna(){return await(0,o.A)(this.userId,"ba05681e16c97c31e1be20e84f250d55",this)}resetUserId(){this.userId=0}async getUserId(){return 0}async getRuntimeId(){return""}async getVersion(){return""}}},70122:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var s=n(98570),r=n(24370),a=n(87251);const i=new r.Q({api:a.default});let o=!1;i.getUserId=async()=>"number"==typeof window.vk?.id?window.vk.id:o?await new Promise((t=>{const e=setInterval((()=>{o||(t(a.default.user_id),clearInterval(e))}),200)})):(a.default.user_id||(o=!0,await a.default.forceUpdateToken(),o=!1),a.default.user_id),i.getRuntimeId=async()=>{const{getManifest:t}=(0,s.A)().browserApi;return t().id},i.getVersion=async()=>{const{getManifest:t}=(0,s.A)().browserApi;return t().version};const c=i},48797:(t,e,n)=>{n.d(e,{A:()=>i});var s=n(74848),r=n(39107),a=n(58006);const i=({children:t,isTabs:e=!1,style:n={},...i})=>{const o=(0,a.A)({isTabs:e});return n.maxHeight||(n.maxHeight=o),(0,s.jsx)(r.guY,{style:n,...i,children:t})}},93750:(t,e,n)=>{n.d(e,{A:()=>f});var s=n(97992),r=n(4255),a=n(96540),i=n(74225),o=n.n(i);const c=["first_name_gen","last_name_gen","is_nft","image_status","sex","photo_50"],d=["photo_50"];var u=n(52370),l=n(70122),p=n(57087);const g=async()=>await l.default.call("profile.getGifts",{}),f=()=>{const{gifts:t,setGifts:e}=(0,p.eg)(),[n,i]=(0,a.useState)(null===t),{usersCache:l,addUserToCache:f}=(0,p.y$)(),{groupsCache:h,addGroupToCache:w}=(0,p.Qm)(),A=(0,a.useCallback)((async()=>{i(!0);const t=await g();e(t?.gifts||[]),i(!1)}),[]);return o()((async n=>{if(null!==t)return;i(!0);const a=await g();if(n())return;if(!a.gifts)return void i(!1);e(a.gifts),i(!1);const o=[],p=[];for(const{from_id:t}of a.gifts){if(!t)continue;r.A.isUserId(t)&&!l.has(t)&&o.push(t);const e=Math.abs(t);r.A.isGroupId(t)&&!h.has(e)&&p.push(e)}for(const t of(0,s.A)(o,20)){const e=await u.vkapiWrapper.users.get({user_ids:t,fields:c});if(n())return;for(const t of e)f(t)}for(const t of(0,s.A)(p,20)){const{groups:e}=await u.vkapiWrapper.groups.getById({group_ids:t,fields:d});if(n())return;for(const t of e)w(t)}}),[t]),{gifts:t||[],forceUpdate:A,isLoading:n}}},22440:(t,e,n)=>{n.d(e,{A:()=>s});const s=()=>"undefined"!=typeof unsafeWindow?unsafeWindow:"undefined"!=typeof window?window:globalThis},4255:(t,e,n)=>{n.d(e,{A:()=>r});const s=Object.freeze({isUserId:t=>t>=1&&t<19e8||t>=2e11&&t<1e12,isGroupId:t=>t<=-1&&t>-1e9,isChatId:t=>t>2e9&&t<21e8,convertChatPeerIdToChatId:t=>t-2e9,convertChatIdToChatPeerId:t=>t+2e9,isZeroOwner:t=>0===t,isUserIdTransitional:t=>(s.isUserId(t),0<t&&t<2e9)}),r=s},97992:(t,e,n)=>{n.d(e,{A:()=>s});const s=(t,e=100)=>{const n=[...t],s=[];for(;n.length;)s.push(n.splice(0,e||n.length));return s}}}]);