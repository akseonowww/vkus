"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[2667,5544,6191,8572],{35172:(e,t,n)=>{n.d(t,{B:()=>o});var o=(0,n(33610).mT)("Icon20HlsOutline","hls_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="hls_outline_20"><path fill="currentColor" d="M3.25 12.89c0 .28-.077.497-.23.65a.784.784 0 0 1-.58.22c-.247 0-.443-.073-.59-.22-.147-.147-.22-.363-.22-.65V7.32c0-.28.073-.493.22-.64a.799.799 0 0 1 .59-.23c.247 0 .443.073.59.22.147.147.22.363.22.65v1.94h3.02V7.32c0-.28.073-.493.22-.64a.799.799 0 0 1 .59-.23c.247 0 .443.073.59.22.147.147.22.363.22.65v5.57c0 .28-.077.497-.23.65a.784.784 0 0 1-.58.22c-.247 0-.443-.073-.59-.22-.147-.147-.22-.363-.22-.65v-2.12H3.25v2.12ZM8.572 7.32c0-.28.073-.493.22-.64a.799.799 0 0 1 .59-.23c.247 0 .443.073.59.22.146.147.22.363.22.65v4.86h1.74c.26 0 .46.067.6.2.14.133.21.32.21.56 0 .233-.074.42-.22.56-.14.133-.337.2-.59.2h-2.55a.815.815 0 0 1-.57-.22c-.16-.147-.24-.347-.24-.6V7.32ZM13.672 11.81c.093 0 .33.07.71.21.38.14.727.21 1.04.21.287 0 .5-.067.64-.2a.627.627 0 0 0 .22-.48c0-.28-.213-.5-.64-.66-.08-.033-.38-.133-.9-.3-.693-.22-1.153-.48-1.38-.78-.22-.307-.33-.693-.33-1.16 0-.747.257-1.327.77-1.74.467-.373 1.064-.56 1.79-.56.64 0 1.137.1 1.49.3.354.193.53.453.53.78 0 .22-.066.403-.2.55a.67.67 0 0 1-.52.22c-.127 0-.386-.06-.78-.18-.22-.067-.42-.1-.6-.1a.83.83 0 0 0-.54.17.512.512 0 0 0-.2.42c0 .207.184.377.55.51.367.127.69.237.97.33.534.173.93.39 1.19.65.36.353.54.84.54 1.46 0 .793-.263 1.4-.79 1.82-.486.387-1.13.58-1.93.58-.573 0-1.09-.093-1.55-.28-.56-.227-.84-.527-.84-.9 0-.24.067-.443.2-.61a.666.666 0 0 1 .56-.26Z" /></symbol>',20,20,!1,void 0)},76382:(e,t,n)=>{n.d(t,{q:()=>o});var o=(0,n(93543).mT)("Icon24DownloadOutline","download_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="download_outline_24"><path fill-rule="evenodd" d="M12.002 2a.9.9 0 0 1 .9.9v11.002l4.562-4.631a.9.9 0 1 1 1.283 1.263l-6.104 6.195a.9.9 0 0 1-1.284-.001l-6.09-6.206a.9.9 0 1 1 1.286-1.26l4.547 4.633V2.9a.9.9 0 0 1 .9-.9m-8 18.1a.9.9 0 0 1 .9-.9h14.2a.9.9 0 1 1 0 1.8h-14.2a.9.9 0 0 1-.9-.9" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},74732:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(35277);const s=async(e,t)=>{const n=await(0,o._)({url:e,filename:t,type:"convertM3u8ToMp4"});return new File([n],t,{type:"video/mp4"})};var i=n(36008);const r=async(e,t)=>(await i.default.sendMessage("vkn-b-aath",new URL(e).origin+"/*"),await s(e,t))},9794:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{A:()=>d});var s=n(387),i=n(26555),r=n(52352),a=n(93819);const e=await a.A;let c=0;class l{id;listeners=new Map;icon;title;subtitle;progressTotal;progress;onCancel;timeLeft;indicator;progressText;iconUrl;_bytesPerSecond;startTime;interval;constructor(e){const t=e;this.id=`${c++}_${(0,s.A)()}`;const n=this.notifyListeners.bind(this),o=["title","subtitle","progress","progressTotal","onCancel","icon","timeLeft","indicator","progressText","iconUrl"];for(const e of o)Object.defineProperty(this,e,{get:()=>t[e],set(o){t[e]=o,n(e,o)}});this._bytesPerSecond=0,this.startTime=Date.now()}notifyListeners=(e,t)=>{if(this.listeners.has(e))for(const n of this.listeners.get(e))n(t)};addChangePropertyListener=(e,t)=>{const n=this.listeners.get(e)||new Set;return n.add(t),this.listeners.set(e,n),()=>{n.delete(t),this.listeners.set(e,n)}};updateBytesPerSecond=e=>{this._bytesPerSecond+=e};updateTimeLeft=(t,n=this.progress,o=this.progressTotal,s=0)=>{if(void 0===n)return;s||(s=(0,r.A)(n,0,o||100)),this.updateBytesPerSecond(t);const i=Date.now()-this.startTime;let a=`0${e.use("vkcom_time_s")}`;s<100&&(a=new Date(100*i/s-i),a=[[a.getUTCFullYear()-1970,e.use("vkcom_time_y")],[a.getUTCMonth(),e.use("vkcom_time_mo")],[a.getUTCDate()-1,e.use("vkcom_time_d")],[a.getUTCHours(),e.use("vkcom_time_h")],[a.getUTCMinutes(),e.use("vkcom_time_m")],[a.getUTCSeconds(),e.use("vkcom_time_s")]].filter((e=>!!e[0])).slice(0,2).map((e=>e.join(""))).join(" ")||`0${e.use("vkcom_time_s")}`),this.timeLeft=a};startSpeed(){return this.stopSpeed(),this.indicator=(0,i.A)(0),this.interval=setInterval((()=>{this.indicator=(0,i.A)(this._bytesPerSecond)+"/s",this._bytesPerSecond=0}),1e3),()=>{this.stopSpeed()}}clearIndicator(){this.stopSpeed(),this.progress=this.progressTotal=this.timeLeft=this.indicator=void 0}stopSpeed(){this.interval&&(clearInterval(this.interval),delete this.interval)}}const d=l;o()}catch(e){o(e)}}),1)},4336:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(74848),s=n(1145),i=n(3068),r=n(70459);const a=new class{wrapper=document.createElement("li");_unsafeUnmount=null;listeners=[];events=[];getEvents(){return[...this.events]}addEvent(e){return this.events.push(e),this.onEventsChange(),()=>{this.events=this.events.filter((t=>t!==e)),this.onEventsChange()}}removeEvent(e){this.events=this.events.filter((t=>t.id!==e)),this.onEventsChange()}addEventsChangeListener(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}onEventsChange(){for(const e of this.listeners)e(this.getEvents());this.events.length>=1?(0,s.A)((()=>this.renderManager())):this.removeManager()}async downloadFileFromLink(e,t){const o=(await n.e(7746).then(n.bind(n,37746))).default;await o(e,t)}async renderManager(){if(this.wrapper.parentElement)return;this.wrapper.className="HeaderNav__item";const e=document.querySelector(".HeaderNav,#top_nav");if(!e)return void console.error("HeaderNav not found");const t=e.querySelector(".HeaderNav__audio");t?(t.insertAdjacentElement("afterend",this.wrapper),this.wrapper.style.order=""):(e.appendChild(this.wrapper),this.wrapper.style.order="-1"),this._unsafeUnmount&&this._unsafeUnmount();const{default:s}=await Promise.all([n.e(2551),n.e(7983),n.e(2020),n.e(3543),n.e(9452),n.e(2477),n.e(6052)]).then(n.bind(n,86052)),{unmount:a}=await(0,i.A)({root:this.wrapper,content:(0,o.jsx)(s,{}),disableParentTransformForPositionFixedElements:!0,disablePortal:!0,wrapperProps:{className:r.A.DownloadManagerPopup}});this._unsafeUnmount=a}removeManager(){0===this.events.length&&(this.wrapper.parentElement&&this.wrapper.remove(),this._unsafeUnmount&&(this._unsafeUnmount(),this._unsafeUnmount=null))}}},88298:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{N:()=>i.A,j:()=>s.A});var s=n(9794),i=n(4336),r=e([s]);s=(r.then?(await r)():r)[0],o()}catch(e){o(e)}}))},2554:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{default:()=>_});var s=n(74848),i=n(35172),r=n(76382),a=n(39107),c=n(96540),l=n(74225),d=n.n(l),u=n(90275),h=n(87675),p=n(3068),m=n(70459),A=n(47194),f=n(60930),v=e([h,f]);[h,f]=v.then?(await v)():v;const _=({player:e})=>{const t=(0,h.A)(),[n,o]=(0,c.useState)(null),[l,v]=(0,c.useState)(null===n);d()((async t=>{v(!0);const n=await(0,A.A)(e);t()&&(o(n),v(!1))}),[]);return(0,s.jsx)(u.Ku,{placement:"top",actions:(()=>{if(l)return(0,s.jsx)(u.vH,{children:t.use("global_loading")});if(n?.qualities?.length){const{qualities:e,title:o}=n;return e.map((([e,n])=>{const[r,c]=n,l=`${e}_${c?1:0}`,d=(0,s.jsx)(u.vH,{onClick:c?()=>(0,f.A)({url:r,title:o,quality:e}):void 0,rightIcon:c&&(0,s.jsx)(i.B,{}),href:c?void 0:r,download:c?void 0:`${o}_${e}p.mp4`,children:`${e}p`},l);return c?(0,s.jsx)(a.m_M,{usePortal:(0,p.P)(),placement:"right",appearance:"accent",enableInteractive:!0,description:(0,s.jsx)("span",{className:m.A.VideoPlayerHlsWarning__text,children:t.use("vkcom_hls_video_warning")}),className:m.A.VideoPlayerHlsWarning__tooltip,offsetByMainAxis:-8,maxWidth:320,children:d},l):d}))}return(0,s.jsx)(u.vH,{disabled:!0,children:t.use("global_not_found")})})(),children:(0,s.jsx)("div",{className:"videoplayer_controls_item videoplayer_btn",role:"button",tabIndex:0,"aria-label":t.use("global_download"),"aria-haspopup":"true","aria-expanded":"false",children:(0,s.jsx)("div",{className:`videoplayer_btn_icon ${m.A.VideoPlayerDownloadIcon}`,children:l?(0,s.jsx)(a.y$y,{}):(0,s.jsx)(r.q,{})})})})};o()}catch(e){o(e)}}))},60930:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{A:()=>d});var s=n(88908),i=n(93819),r=n(74732),a=n(88298),c=e([a]);a=(c.then?(await c)():c)[0];const l=/#EXTINF:.+?\n(.+?)\n/g,d=async({url:e,title:t,quality:o})=>{const c=new AbortController,{signal:d}=c,u=await i.A,h=new a.j({icon:"hls_video",title:(0,s.A)(`${t}_${o}p.mp4`),subtitle:u.use("vkcom_downloading"),onCancel:()=>c.abort()}),p=a.N.addEvent(h);try{const t=await(0,r.A)(e,h.title),n=URL.createObjectURL(t);return await a.N.downloadFileFromLink(n,h.title),URL.revokeObjectURL(n),void p()}catch(e){console.error(e)}h.title=(0,s.A)(`${t}_${o}p.zip`);const m=e.split("/").slice(0,-1).join("/")+"/",A=await fetch(e,{signal:d});let f=await A.text();const v=[...f.matchAll(l)];h.progress=0,h.progressTotal=v.length,h.subtitle="",h.startSpeed();const _=[],g=new Date;let w=0;for(let e=0;e<v.length;e+=5){if(d.aborted)return;const t=v.slice(e,e+5).map((e=>new Promise((async t=>{try{const[,n]=e,o=await fetch(m+n,{signal:d});if(!o.body)throw new Error;const s=o.body.getReader(),i=+(o.headers.get("Content-Length")||"0"),r=new Uint8Array(i);let a=0;for(;;){const{done:e,value:t}=await s.read();if(e)break;r.set(t,a),a+=t.length,h.updateTimeLeft(t.length)}const c="chunks/"+`${"0".repeat(v.length.toString().length)}${w+1}`.slice(-v.length.toString().length)+"."+n.split(".").reverse()[0];f=f.replace(n,c),++w,h.progress=w,t({name:c,lastModified:g,input:new Blob([r])})}catch(e){t(void 0)}}))));for(const e of await Promise.all(t))e&&_.push(e)}if(_.push({name:"index.m3u8",lastModified:g,input:new Blob([f])}),d.aborted)return;h.clearIndicator(),h.indicator=u.use("vkcom_archivation");const{downloadZip:y}=await n.e(1941).then(n.bind(n,71941)),b=await y(_).blob(),x=URL.createObjectURL(b);await a.N.downloadFileFromLink(x,h.title),URL.revokeObjectURL(x),p(),h.stopSpeed()};o()}catch(e){o(e)}}))},47194:(e,t,n)=>{n.d(t,{A:()=>i});const o=/<Representation .*? ?height="(.+?)".*?<BaseURL>(.+?)<\/BaseURL>.*?<\/Representation>/g,s=/,RESOLUTION=.+?x(\d+),?.*?\n(.+?)(\n|$)/g;const i=async function(e){const t={};if(e.manifest)try{for(const[,n,s]of e.manifest.matchAll(o))!s||isNaN(+n)||t[+n]||(t[+n]=[s.replaceAll("&amp;","&"),!1])}catch(e){console.error("can't parse manifest"),console.error(e)}if(e.hls_ondemand)try{const n=e.hls_ondemand.split("/").slice(0,-1).join("/")+"/",o=await fetch(e.hls_ondemand),i=await o.text();for(const[,e,o]of i.matchAll(s))!o||isNaN(+e)||t[+e]||(t[+e]=[n+o,!0])}catch(e){console.error("can't parse hls_ondemand"),console.error(e)}if(e.hls_raw)try{for(const[,n,o]of e.hls_raw.matchAll(s))!o||isNaN(+n)||t[+n]||(t[+n]=[o,!0])}catch(e){console.error("can't parse hls_raw"),console.error(e)}else if(e.hls)try{const n=await fetch(e.hls),o=await n.text(),i=new URL(e.hls).origin;for(const[,e,n]of o.matchAll(s)){if(!n||isNaN(+e)||t[+e])continue;const o=new URL(n,i).toString();t[+e]=[o,!0]}}catch(e){console.error("can't parse hls"),console.error(e)}for(const n of Object.keys(e)){if(!n.startsWith("url"))continue;const o=+n.slice(3);isNaN(o)||(t[+o]=[e[n],!1])}const n=[],i=[];for(const e of Object.keys(t).map((e=>+e)).sort(((e,t)=>e>t?1:e<t?-1:0)))i.includes(t[e])||(i.push(t[e]),n.unshift([e,t[e]]));return{title:e.md_title,qualities:n}}},87675:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{A:()=>i});var s=n(93819);const e=await s.A,i=()=>e;o()}catch(e){o(e)}}),1)},7646:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(74848),s=n(39107),i=n(42335);const r=({className:e,children:t,getRootRef:n,useScrollView:r,...a})=>r?(0,o.jsx)(s.guY,{getRootRef:n,className:(0,s.xWm)(i.A.ActionsMenu,e),children:t}):(0,o.jsx)("div",{ref:n,...a,className:(0,s.xWm)(i.A.ActionsMenu,e),children:t})},62882:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(74848),s=n(39107),i=n(53339);const r={large:i.A["ActionsMenuAction--size-large"],regular:i.A["ActionsMenuAction--size-regular"],max:i.A["ActionsMenuAction--size-max"]},a={primary:i.A["ActionsMenuAction--primary"],secondary:i.A["ActionsMenuAction--secondary"],danger:i.A["ActionsMenuAction--danger"],warning:i.A["ActionsMenuAction--warning"]},c=({leftIcon:e,rightIcon:t,title:n,subtitle:c,type:l="secondary",size:d="regular",isActive:u=!1,hasHover:h=!0,isLoading:p,className:m,onClick:A,titleClassName:f,getRootRef:v,href:_,Component:g=(_?"a":"button"),children:w,...y})=>(0,o.jsxs)(g,{className:(0,s.xWm)(i.A.ActionsMenuAction,h&&i.A["ActionsMenuAction--hover"],(A||h||_)&&i.A["ActionsMenuAction--clickable"],a[l],p&&i.A["ActionsMenuAction--loading"],u&&i.A["ActionsMenuAction--active"],r[d],m),onClick:p?void 0:A,ref:v,href:_,...y,children:[e&&(0,o.jsx)("i",{className:i.A.ActionsMenuAction__icon,children:e}),(0,o.jsxs)("span",{title:n,className:(0,s.xWm)(i.A.ActionsMenuAction__title,f),children:[w,c&&(0,o.jsx)("span",{className:i.A.ActionsMenuAction__subtitle,children:c})]}),t&&(0,o.jsx)("i",{className:i.A.ActionsMenuAction__icon,children:t})]})},22860:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(74848),s=n(75623),i=n(39107),r=n(7646);const a=({children:e,actions:t,actionsMenuClassName:n,hideOnClick:a=!0,disabled:c=!1,useScrollView:l=!1,...d})=>c?e:(0,o.jsx)(s.A,{content:(0,o.jsx)(r.A,{useScrollView:l,className:(0,i.xWm)(n),children:t}),noBackground:!0,hideOnClick:a,...d,children:e})},83558:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(74848),s=n(39107),i=n(44511);const r=({getRootRef:e,className:t,...n})=>(0,o.jsx)("div",{role:"separator",className:(0,s.xWm)(i.A.ActionsMenuActionSeparator,t),ref:e,...n})},90275:(e,t,n)=>{n.d(t,{AS:()=>s.A,Ku:()=>i.A,vH:()=>o.A});n(7646);var o=n(62882),s=n(83558),i=n(22860)},75623:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(74848),s=n(39107),i=n(96540),r=n(61166);const a=({hideOnClick:e=!1,noBackground:t=!1,mode:n,onClick:a,onShownChange:c,className:l,contentWrapperClassName:d,shown:u,content:h,...p})=>{const[m,A]=(0,i.useState)(!1),f=(0,i.useRef)(null),v=(0,i.useRef)(null),_=(0,i.useCallback)((e=>{e?A(!0):f.current=setTimeout((()=>{A(!1)}),100),c?.(e)}),[n,c,A]);return(0,i.useEffect)((()=>{"boolean"==typeof u&&_(u)}),[u,_]),(0,o.jsx)(s.AMh,{shown:m,className:(0,s.xWm)(r.A.PopoverReforged,t&&r.A["PopoverReforged--noBackground"],l),onShownChange:_,onClick:e=>{if("side"===n&&f.current)clearTimeout(f.current);else try{a?.(e)}catch(e){console.error(e)}},content:(0,o.jsx)("div",{ref:v,className:(0,s.xWm)(d),onClick:t=>{e&&v.current?.contains(t.target)&&A(!1)},children:h}),...p})}},52352:(e,t,n)=>{n.d(t,{A:()=>o});const o=(e,t,n)=>e<t?0:e>n?100:(e-t)/(n-t)*100},88908:(e,t,n)=>{n.d(t,{A:()=>s});const o=document.createElement("textarea"),s=e=>(o.innerHTML=e,o.innerText)},70459:(e,t,n)=>{n.d(t,{A:()=>o});const o={AudioPageMainTabBtn:"XYzoAKWs2KhH02Ye",AudioArtistHeaderActions:"v8VBorduCtZgTyyi",VideoPlayerDownloadIcon:"eaSw45y_1KLlo4Gw",SecondaryAttachment__afterItem:"RZ6NWD1WvjAOxG2Y",DownloadManagerPopup:"o9vy1XhnZrkvykUb",VideoPlayerHlsWarning__tooltip:"P9MhdlrtilEQt7Am",VideoPlayerHlsWarning__text:"Xq2PVks6OK6Z74Al",AudioPlaylistSnippet__actions:"FawmW4_Zd1R1BI1E",AudioPlaylistSnippet__actionButton:"ZPr5mXzL52VUPaRe",ActionButton__icon:"_5bFyslOmNjqqP7y",ActionButton__text:"o7YAH98fI9KVToa5",AudioPlayerUserControlsContainer__userButton:"e47qq1XqMPp6oTp7",AudioPlayerPlaybackButton:"wqb5e3cgYZFgHCc1",AudioRowReact__button:"q7d6KTdMjs6HYpKm"}},42335:(e,t,n)=>{n.d(t,{A:()=>o});const o={ActionsMenu:"oXPVlZtlcjoi6d8e"}},53339:(e,t,n)=>{n.d(t,{A:()=>o});const o={ActionsMenuAction:"Qz12flm1ckhwWMRi","ActionsMenuAction--clickable":"zqSAHhp0mZkpJyJv","ActionsMenuAction--loading":"maWKomPpZn38CGdY",ActionsMenuAction__title:"f5DiFbY0HMzfonGH","ActionsMenuAction--hover":"eArigbMXC9scSDcE","ActionsMenuAction--active":"dKO8yhdsvq5OQaLB","ActionsMenuAction--size-regular":"JSPJNQnfc0rmrUKc","ActionsMenuAction--size-large":"Kz6XOr7wirTW6rZ_","ActionsMenuAction--size-max":"I5pyzjxjokMaCjf_",ActionsMenuAction__icon:"CIshpRBaU1ScuMSN","ActionsMenuAction--primary":"shY5I45XLLb2peEz","ActionsMenuAction--secondary":"CHnF5e3RJGJOddfX","ActionsMenuAction--danger":"bdbcNwBFv_xx4hSf","ActionsMenuAction--warning":"dIPqyT74MfEGnvhg",ActionsMenuAction__subtitle:"Z9G_cg7qHFwNychh"}},44511:(e,t,n)=>{n.d(t,{A:()=>o});const o={ActionsMenuActionSeparator:"JUUAV9aJuLWPapUx"}},61166:(e,t,n)=>{n.d(t,{A:()=>o});const o={PopoverReforged:"V5vFILKwsuTAoDXp","reforged-anim-fade-in":"aKnVnnmt_OsWj600","reforged-anim-fade-out":"uvPWUxQQgpV6cgFC","PopoverReforged--noBackground":"h4DVtB6f3FyJCExI"}},40961:(e,t,n)=>{!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(22551)},74225:(e,t,n)=>{var o=n(96540);function s(e,t,n){var s="function"==typeof t;o.useEffect((function(){var n,o=!0,i=e((function(){return o}));return Promise.resolve(i).then((function(e){n=e})),function(){o=!1,s&&t(n)}}),s?n:t)}e.exports=s,e.exports.useAsyncEffect=s},55073:(e,t,n)=>{n.d(t,{c:()=>o});const o=()=>{let e,t;return{promise:new Promise(((n,o)=>{e=n,t=o})),resolve:e,reject:t}}},35277:(e,t,n)=>{n.d(t,{_:()=>l});var o=n(55073);const s=e=>new Promise((t=>setTimeout(t,e)));let i,r=null,a=0;const c=async()=>{i||(i=(async()=>{if(await s(6e4),!r)return;const e=await r;e&&(0===a&&await s(1e4),0===a&&(r=null,e.remove()))})(),i.finally((()=>{i=null})))},l=async({onProgress:e,type:t,iframeURL:s="https://vknext.net/ffmpeg",...i})=>{const{promise:l,reject:d,resolve:u}=(0,o.c)(),h="request-"+Math.random().toString(36).substr(2,9),p=await(e=>{if(r)return r;const{promise:t,resolve:n,reject:s}=(0,o.c)();r=t;const i=document.querySelector(`iframe[src="${e}"]`);if(i)return n(i),t;const a=document.createElement("iframe");return a.src=e,a.style.setProperty("display","none","important"),a.onload=()=>n(a),a.onerror=s,(document.body||document.documentElement).appendChild(a),t})(s),{Bridge:m}=await n.e(2692).then(n.bind(n,42692)),A=new m(p.contentWindow,{prefix:"vknext-net-bridge"});return a++,e&&A.on("progress",(t=>{const n=t;n?.requestId===h&&e(n.progress,n.total)})),A.on("error",(e=>{const t=e;t?.requestId===h&&(d(t?.error||"unknown error"),A.destroy(),a--,c())})),A.on("response",(e=>{const t=e;t?.requestId===h&&(u(t.response),A.destroy(),a--,c())})),A.on("getBlob",(e=>{const t=e;if(t?.requestId===h)return fetch(t.url).then((e=>e.blob()))})),A.post(t,{...i,requestId:h}),l}}}]);