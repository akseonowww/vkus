"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[3023],{7708:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(74848),n=s(48081),i=s(39107),r=s(13742),l=s(68741),o=s(91691);const c="zRIhm_rzeRaOj2Bs",u="m8aAYX3glAEj5Q3G",d=({beforeClassname:e,backPage:t,hideButtonIsFirstPage:s,hideBackButtonInTablet:d,children:h,..._})=>{const w=(0,n.XC)(),x=(0,n.Gz)(),{width:g}=(0,r.A)();let v=s&&w&&(0,o.A)();return d&&(g||800)>768&&(v=!0),(0,a.jsx)(i.aOn,{before:!v&&(0,a.jsx)(i.Hy0,{onClick:async()=>{w?t?await x.replace(t):await x.push(l.JZ.root.main.home):await x.back()},className:(0,i.xWm)(c,e),hideLabelOnIOS:!0}),..._,children:(0,a.jsx)("div",{className:u,children:h})})}},13023:(e,t,s)=>{s.a(e,(async(e,a)=>{try{s.r(t),s.d(t,{default:()=>m});var n=s(74848),i=s(48081),r=s(39107),l=s(96540),o=s(74225),c=s.n(o),u=s(7708),d=s(8015),h=s(68741),_=s(57087),w=s(82050),x=e([d]);d=(x.then?(await x)():x)[0];const g=(0,l.lazy)((()=>Promise.all([s.e(1092),s.e(681),s.e(9041)]).then(s.bind(s,70681)))),v=(e,t)=>e||!["all","friends_and_contacts"].includes(t||"")?"allow":"exclude",m=()=>{const e=(0,d.A)(),{viewer:t}=(0,_.ur)(),{showSnackbar:a,hideSnackbar:o}=(0,_.Qs)(),x=(0,i.Gz)(),{mode:m}=(0,i.g)()??{},[f]=(0,l.useState)("allow"===m),k=(0,l.useRef)(null),b=(0,l.useRef)(null),[p,j]=(0,l.useState)(0),[y,P]=(0,l.useState)(null);(0,l.useLayoutEffect)((()=>{j(b.current?.offsetHeight??0)}),[b]),c()((async e=>{const{vkapiWrapper:t}=await Promise.resolve().then(s.bind(s,52370)),{response:a}=await t.execute({code:"return API.account.getPrivacySettings({privacy_keys: 'online', need_default: 0}).settings[0].value.owners;"});e()&&P(a?.allowed&&f?a.allowed:!a?.excluded||f?[]:a.excluded)}),[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.A,{backPage:h.JZ.root.main_0_0.activity,after:(0,n.jsx)(r.ae4,{onClick:async()=>{if(!t?.id)return;if(null===k.current)return void a((0,n.jsx)(r.qb_,{onClose:o,children:e.use("settings_friends_not_selected")}));x.showPopout((0,n.jsx)(r.WHT,{state:"loading"}));const{vkapiWrapper:i}=await Promise.resolve().then(s.bind(s,52370)),{response:l}=await i.execute({code:"return API.account.getPrivacySettings({privacy_keys: 'online', need_default: 0}).settings[0].value.category;"}),c="allow"===v(f,l),u=k.current.map((e=>c?e.id:-e.id));u.unshift(c?"some_friends":l||"only_me");const d=(await Promise.resolve().then(s.bind(s,49876))).default,_=await d({userId:t.id,onError:()=>{a((0,n.jsx)(r.qb_,{duration:2e3,onClose:o,children:e.use("settings_vkme_set_online_error")}))}});_?(await _.account.setPrivacy({key:"online",value:u}),x.showPopout((0,n.jsx)(r.WHT,{state:"done"})),await(0,w.A)(1e3),await x.replace(h.JZ.root.main_0_0.activity),x.hidePopout()):x.push(h.JZ.root.main_0_0.vkmessenger)},label:(0,n.jsx)(n.Fragment,{children:e.use("global_save")})}),children:e.use("settings_menu_vkme_manager_title")}),(0,n.jsxs)(r.YJl,{children:[(0,n.jsx)("div",{ref:b,children:(0,n.jsx)(r.iau,{children:(0,n.jsx)(r.lZ$,{title:f?e.use("settings_friends_show_online"):e.use("settings_friends_no_show_online")})})}),null===y?(0,n.jsx)(r.qBl,{}):(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)(r.qBl,{}),children:(0,n.jsx)(g,{extraHeight:p,selectedUserIds:y??[],onSelect:e=>{k.current=e}})})]})]})};a()}catch(e){a(e)}}))}}]);