"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[9106],{80580:(e,t,s)=>{s.d(t,{A:()=>u});var l=s(96540),n=s(74225),r=s.n(n),a=s(52370);const o=({offset:e=0,filter:t="all",count:s=100,owner_id:l})=>{const n={offset:e,count:s,filter:t,extended:1};return l&&(n.owner_id=l),a.vkapiWrapper.wall.get(n)};const i=async function*(e,t=0){try{const{count:s}=await o({offset:0,count:0,filter:e,owner_id:t?-t:void 0});if(yield{count:s,offset:0,items:[]},0===s)return;let l=0;for(;l<s;){const n=[o({offset:l,filter:e,owner_id:t?-t:void 0})];l+100<s&&n.push(o({offset:l+100,filter:e,owner_id:t?-t:void 0}));for(const e of n){try{const{items:n}=await e;if(0===n.length)return;console.log("[vknext/cleaner/getWall]",{items:n,groupId:t,offset:l,allCount:s}),yield{count:s,offset:l,items:n||[]}}catch(e){console.error(e)}l+=100}}}catch(e){console.error(e),yield{count:0,offset:0,items:[]}}};var c=s(57610);const u=(e="")=>{const[t,s]=(0,l.useState)(null),[n,a]=(0,l.useState)(null),[o,u]=(0,l.useState)(0),[d,h]=(0,l.useState)(0),f=(0,c.F9)();return r()((async t=>{if(""===e)return;s(null),a(null),u(0),h(0);const l=new Set,n=new Map;for await(const{offset:s,count:r,items:a}of i(e,f)){if(!t())return;if(0===s&&(h(r),u(0)),0===r){h(s);break}for(const e of a)if(e.can_delete&&(l.add(e),e.owner_id,e.date)){const t=new Date(1e3*e.date).getFullYear(),s=n.get(t)||new Set;s.add(e),n.set(t,s)}u(l.size)}t()&&(s(Array.from(l)),a(n))}),[e,f]),{wall:t,wallYears:n,progress:o,allCount:d}}},47012:(e,t,s)=>{s.a(e,(async(e,l)=>{try{s.d(t,{A:()=>f});var n=s(74848),r=s(7139),a=s(8015),o=s(48081),i=s(39107),c=s(96540),u=s(57610),d=s(38643),h=e([r,a]);[r,a]=h.then?(await h)():h;const f=({ownerWallYears:e,othersWallYears:t,archivedWallYears:s,onSelected:l})=>{const h=(0,a.A)(),f=(0,o.Gz)(),[w,_]=(0,c.useState)({owner:new Set,others:new Set,archived:new Set}),g=0===(0,u.F9)(),x=(e,t)=>{_((s=>({...s,[e]:t})))},m=(0,c.useMemo)((()=>{const e=new Set;return w.owner.forEach(e.add,e),w.others.forEach(e.add,e),w.archived.forEach(e.add,e),e}),[w.owner,w.others,w.archived]);return(0,n.jsxs)(i.YJl,{children:[(0,n.jsxs)(i.eIh,{top:h.use("settings_cleaner_wall_select"),children:[(0,n.jsx)(d.A,{wallYears:e,label:h.use("settings_cleaner_wall_owner"),onSelected:e=>x("owner",e)}),(g||t.size>0)&&(0,n.jsx)(d.A,{wallYears:t,label:h.use("settings_cleaner_wall_others"),onSelected:e=>x("others",e)}),(g||s.size>0)&&(0,n.jsx)(d.A,{wallYears:s,label:h.use("settings_cleaner_wall_archived"),onSelected:e=>x("archived",e)})]}),(0,n.jsx)(i.iau,{children:(0,n.jsx)(i.lZ$,{extraSubtitle:h.use("settings_cleaner_wall_warning")})}),(0,n.jsx)(i.eIh,{children:(0,n.jsx)(i.$nd,{mode:"primary",stretched:!0,size:"m",disabled:0===m.size,onClick:()=>{f.showPopout((0,n.jsx)(i.FcD,{actions:[{title:h.use("global_cancel"),mode:"cancel"},{title:h.use("global_remove"),mode:"destructive",action:()=>l(m)}],onClose:()=>f.hidePopout(),title:h.use("settings_confirm_action"),description:h.use("settings_cleaner_wall_confirm_clear",{count:m.size}),actionsLayout:"horizontal"}))},after:(0,n.jsx)(r.A.Prime,{}),children:h.use("settings_cleaner_wall_clear_button",{count:m.size})})})]})};l()}catch(e){l(e)}}))},38643:(e,t,s)=>{s.d(t,{A:()=>a});var l=s(74848),n=s(39107),r=s(96540);const a=({wallYears:e,label:t,onSelected:s})=>{const[a,o]=(0,r.useState)([]),i=(0,r.useMemo)((()=>Array.from(e.values())),[e]).reduce(((e,t)=>e+t.size),0),c=a.reduce(((t,s)=>t+(e.get(s)?.size||0)),0);return(0,r.useEffect)((()=>{const t=new Set;for(const s of a){const l=e.get(s);l&&l.forEach(t.add,t)}s(t)}),[a,e]),(0,l.jsxs)(n.nD3,{children:[(0,l.jsxs)(n.nD3.Summary,{iconPosition:"before",disabled:0===i,multiline:!0,children:[t," (",0===i?0:`${c}/${i}`,")"]}),(0,l.jsx)(n.nD3.Content,{children:(0,l.jsx)(n.iau,{children:Array.from(e.entries()).map((([e,t])=>(0,l.jsxs)(n.Sc0,{checked:a.includes(e),onChange:()=>o((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e])),children:[e," (",t.size,")"]},e)))})})]})}},65406:(e,t,s)=>{s.a(e,(async(e,l)=>{try{s.r(t),s.d(t,{default:()=>p});var n=s(74848),r=s(52370),a=s(58006),o=s(85252),i=s(8015),c=s(68741),u=s(48081),d=s(39107),h=s(96540),f=s(58207),w=s(49747),_=s(23050),g=s(80580),x=s(57610),m=s(47012),v=e([i,f,w,m]);[i,f,w,m]=v.then?(await v)():v;const j=()=>{const e=(0,i.A)(),{wallYears:t,progress:s,allCount:l}=(0,g.A)("owner"),{wallYears:a,progress:f,allCount:v}=(0,g.A)("others"),{wallYears:j,progress:p,allCount:A}=(0,g.A)("archived"),S=0===(0,x.F9)(),[b,y]=(0,h.useState)(null),[Y,z]=(0,h.useState)(0),[k]=(0,o.A)(),C=(0,u.Gz)();return null===t||null===a||null===j?(0,n.jsxs)(d.YJl,{children:[(0,n.jsx)(_.A,{value:s,max:l,label:e.use("settings_cleaner_wall_getting_owner")}),(S||f>0)&&(0,n.jsx)(_.A,{value:f,max:v,label:e.use("settings_cleaner_wall_getting_others")}),(S||p>0)&&(0,n.jsx)(_.A,{value:p,max:A,label:e.use("settings_cleaner_wall_getting_archived")})]}):null!==b?Y===b?(0,n.jsx)(w.A,{}):(0,n.jsx)(d.YJl,{children:(0,n.jsx)(_.A,{value:Y,max:b,label:e.use("settings_cleaner_wall_clearing")})}):(0,n.jsx)(m.A,{ownerWallYears:t,othersWallYears:a,archivedWallYears:j,onSelected:async e=>{if(k){y(e.size),z(0);for(const t of e)try{await r.vkapiWrapper.wall.delete({owner_id:t.owner_id,post_id:t.id}),z((e=>e+1))}catch(e){console.error(e)}}else C.push(c.JZ.root.main.prime)}})},p=()=>{const e=(0,i.A)(),t=(0,a.A)({isGroup:!0});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.A,{children:e.use("settings_menu_cleaner_wall_title")}),(0,n.jsx)(d.guY,{style:{maxHeight:t},children:(0,n.jsx)(j,{})})]})};l()}catch(e){l(e)}}))}}]);