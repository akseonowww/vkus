"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[2441],{32441:(o,e,r)=>{r.d(e,{A:()=>C});var t=r(14943),a=r(95684),n=r(67992),_=r(38729),c=r(94169),i=r(45939);const l=new n.A,s=(0,_.NS)(),u=(0,_.sr)(),d=async o=>{if(!o[u]){o[u]=!0,await(0,t.A)();for(const e of l.listeners)await(0,a.A)(),e(o)}},k=(o,e)=>{o[s]||(o[s]=new MutationObserver((async o=>{for(const r of o)for(const o of r.addedNodes){const r=o;r.parentElement&&e(r)}})),o[s].observe(o,{childList:!0}),i.A.add(o))},v=o=>{for(const e of o.getElementsByClassName("ConvoHistory__content"))g(e);k(o,g)},g=o=>{for(const e of o.getElementsByClassName("ConvoHistory__flow"))b(e);k(o,b)},b=o=>{for(const e of o.getElementsByClassName("ConvoHistory__dateStack"))m(e);k(o,m)},m=async o=>{for(const e of o.getElementsByClassName("ConvoStack"))p(e);k(o,p)},p=o=>{for(const e of o.getElementsByClassName("ConvoStack__content"))y(e);k(o,y)},y=o=>{for(const e of o.getElementsByClassName("VirtualScrollItem"))h(e);k(o,h)},h=o=>{const e=async()=>{await(0,a.A)(),await(0,t.A)();for(const e of o.getElementsByClassName("ConvoMessage"))await d(e);for(const e of o.getElementsByClassName("ConvoMessageWithoutBubble"))await d(e)};e().catch(console.error),k(o,e)},f=()=>{const o=document.getElementById("reforged-root")||document;for(const e of o.getElementsByClassName("ConvoMain__history"))v(e)};let w=!1;const C=o=>{const e=l.addListener(o);for(const o of document.getElementsByClassName("ConvoMessage"))d(o).catch(console.error);for(const o of document.getElementsByClassName("ConvoMessageWithoutBubble"))d(o).catch(console.error);return w||(w=!0,(0,c.A)(f)),e}},45939:(o,e,r)=>{r.d(e,{A:()=>c});var t=r(49032),a=(r(98570),r(4107)),n=r(73737);class _ extends n.A{async initClear(){if(this.isClearInit)return;this.isClearInit=!0;const o=(await(0,a.A)()).onLocationChange((e=>{e.startsWith("im")||t.lz.test(e)||(this.clear(),o(),this.isClearInit=!1)}))}}const c=new _},5679:(o,e,r)=>{r.d(e,{A:()=>i});var t=r(67992),a=r(2519);const n=new t.A,_=new t.A,c=async()=>{(o=>{if(o._meAppHooked)return;o._meAppHooked=!0;const e=o.store.dispatch;let r=o.store.getState()?.ownerId;o.store.dispatch=function(...t){const[a]=t;r||(r=o.store.getState()?.ownerId);let c=!1;for(const o of _.listeners)try{const e=o(a);"boolean"==typeof e&&e&&(c=!0)}catch(o){console.error(o)}if(c)return;const i=Reflect.apply(e,o.store,t);for(const o of n.listeners)try{o(a)}catch(o){console.error(o)}return i}})(await(0,a.A)())},i=(o,e=!1)=>{const r=(e?n:_).addListener(o);return c(),r}},94169:(o,e,r)=>{r.d(e,{A:()=>l});var t=r(67992),a=r(5679);const n=new t.A,_=async o=>!!document.querySelector(".ConvoMain")&&(await(async o=>{for(const e of n.listeners)try{e?.(o)}catch(o){console.error(o)}})(o),!0);let c,i;(0,a.A)((async o=>{if("UserOpenedConvo"===o.type&&(c=o.peerId,!await _(o.peerId))){i&&clearTimeout(i);const e=setTimeout((async()=>{o.peerId===c?await _(o.peerId)&&clearTimeout(e):clearTimeout(e)}),800);i=e}}),!0);const l=o=>n.addListener(o)},49032:(o,e,r)=>{r.d(e,{Fl:()=>_,XZ:()=>n,hj:()=>a,lz:()=>t});const t=/(^|\/)al_im\.php|(^|\/)im(\?|$)|(^|\/)gim\d+|\/write-?\d+/,a=/(^|\/)al_im\.php|(^|\/)im(\?|$)|\/write-?\d+|\/im\/.*/,n={"--accent":"--vkui--color_icon_accent","--background_content":"--vkui--color_background_content","--background_highlighted":"--vkui--color_transparent--active","--background_hover":"--vkui--color_transparent--hover","--background_light":"--vkui--color_background_tertiary","--background_page":"--vkui--color_background","--background_suggestions":"--vkui--color_background_modal","--button_commerce_background":"--vkui--color_text_positive","--button_secondary_background":"--vkui--color_background_secondary_alpha","--button_secondary_destructive_foreground":"--vkui--color_background_negative","--content_tint_background":"--vkui--color_background_secondary","--content_warning_background":"--vkui--color_background_warning","--counter_prominent_text":"--vkui--color_text_contrast","--destructive":"--vkui--color_text_negative","--dynamic_gray":"--vkui--color_accent_gray","--dynamic_green":"--vkui--color_accent_green","--dynamic_orange":"--vkui--color_accent_orange","--dynamic_purple":"--vkui--color_accent_purple","--dynamic_red":"--vkui--color_accent_red","--dynamic_violet":"--vkui--color_accent_violet","--dynamic_blue":"--vkui--color_accent_blue","--dynamic_raspberry_pink":"--vkui--color_accent_raspberry_pink","--field_background":"--vkui--color_field_background","--field_border":"--vkui--color_field_border_alpha","--field_error_background":"--vkui--color_background_negative_tint","--field_error_border":"--vkui--color_stroke_negative","--field_valid_border":"--vkui--color_stroke_positive","--header_background":"--vkui--color_header_background","--header_tint_alternate":"--vkui--color_icon_accent_themed","--icon_alpha_placeholder":"--vkui--color_icon_contrast","--icon_medium_alpha":"--vkui--color_icon_medium_alpha","--icon_medium":"--vkui--color_icon_medium","--icon_secondary_alpha":"--vkui--color_icon_secondary_alpha","--icon_secondary":"--vkui--color_icon_secondary","--icon_tertiary_alpha":"--vkui--color_icon_tertiary_alpha","--icon_tertiary":"--vkui--color_icon_tertiary","--image_border":"--vkui--color_image_border_alpha","--input_background":"--vkui--color_write_bar_input_background","--input_border":"--vkui--color_write_bar_input_border_alpha","--link_alternate":"--vkui--color_text_link_themed","--loader_track_fill":"--vkui--color_track_background","--loader_track_value_fill":"--vkui--color_track_buffer","--placeholder_icon_background_opaque":"--vkui--color_image_placeholder_alpha","--placeholder_icon_background":"--vkui--color_image_placeholder","--search_bar_field_background":"--vkui--color_search_field_background","--segmented_control_bar_background":"--vkui--color_segmented_control","--separator_alpha":"--vkui--color_separator_primary_alpha","--separator_alternate":"--vkui--color_separator_secondary","--separator_common":"--vkui--color_separator_primary","--skeleton_foreground_from":"--vkui--color_skeleton_from","--skeleton_foreground_to":"--vkui--color_skeleton_to","--text_link":"--vkui--color_text_link","--text_muted":"--vkui--color_text_muted","--text_primary":"--vkui--color_text_primary","--text_secondary":"--vkui--color_text_secondary","--text_subhead":"--vkui--color_text_subhead","--text_tertiary":"--vkui--color_text_tertiary","--writebar_icon":"--vkui--color_write_bar_icon","--gray_400":"--vkui--color_text_secondary","--gray_500":"--vkui--color_text_subhead","--gray_600":"--vkui--color_text_subhead","--gray_900":"--vkui--color_text_muted","--im_forward_line_tint":"--vkui--vkontakte_color_im_forward_line_alpha","--im_bubble_incoming":"--vkui--vkontakte_color_im_bubble_incoming","--im_bubble_incoming_alternate":"--vkui--vkontakte_color_im_bubble_incoming_alternate","--im_bubble_incoming_expiring":"--vkui--vkontakte_color_im_bubble_incoming_expiring","--im_bubble_border_alternate_highlighted":"--vkui--vkontakte_color_im_bubble_border_alternate_highlighted_alpha","--modal_card_background":"--vkui--color_background_modal","--im_bubble_outgoing":"--vkui--vkontakte_color_im_bubble_outgoing"},_=1e3}}]);