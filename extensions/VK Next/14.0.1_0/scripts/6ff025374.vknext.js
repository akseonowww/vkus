"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[661],{45880:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(96540),r=s(13742);const o=()=>{const{width:e}=(0,r.A)(),[t,s]=(0,n.useState)(0),o=(0,n.useRef)(null);return(0,n.useEffect)((()=>{if(!o.current)return;const e=o.current.getBoundingClientRect();s(e.width)}),[o,e]),{width:t,ref:o,style:{width:"100%",position:"relative",pointerEvents:"none",userSelect:"none",top:0,left:0}}}},65394:(e,t,s)=>{s.d(t,{A:()=>n});const n=new Map},68737:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(4255),r=s(65394),o=s(19171),a=s(66556);const i=e=>{if(n.A.isChatId(e)){const t=r.A.get(e);return t?.chat_settings?.title||""}if(n.A.isUserId(e)&&a.A.has(e)){const t=a.A.get(e);return`${t.first_name} ${t.last_name}`}const t=Math.abs(e);if(n.A.isGroupId(e)&&o.A.has(t)){return o.A.get(t).name}return""}},19171:(e,t,s)=>{s.d(t,{A:()=>n});const n=new Map},66556:(e,t,s)=>{s.d(t,{A:()=>n});const n=new Map},2346:(e,t,s)=>{s.d(t,{A:()=>n});const n=(0,s(96540).createContext)(null)},39044:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(74848),r=s(96540),o=s(68737),a=s(2346);const i=({children:e,items:t,onChange:s})=>{const[i,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(t);(0,r.useEffect)((()=>{s(c)}),[c]);const u=(0,r.useMemo)((()=>i?t.filter((e=>(0,o.A)(e).toLowerCase().indexOf(i.toLowerCase())>-1)):t),[i,t]);return(0,n.jsx)(a.A.Provider,{value:{onChange:s,items:t,search:i,filteredItems:u,setSelectedItems:d,selectedItems:c,setSearch:l},children:e})}},46651:(e,t,s)=>{s.d(t,{A:()=>u});var n=s(74848),r=s(33258),o=s(39107),a=s(65394),i=s(68737),l=s(19171),c=s(66556),d=s(15200);const u=({index:e})=>{const{filteredItems:t,selectedItems:s,setSelectedItems:u}=(0,d.A)(),h=a.A.get(t[e]);if(!h)return null;const f=(0,i.A)(h.peer.id),g=s.includes(h.peer.id),p=()=>{u((e=>e.includes(h.peer.id)?e.filter((e=>e!==h.peer.id)):[...e,h.peer.id]))};if("chat"===h.peer.type){const e=h.chat_settings?.photo?.photo_50||h.chat_settings?.photo?.photo_100;return(0,n.jsx)(o.T6P,{before:(0,n.jsx)(o.euF,{size:40,src:e,gradientColor:(0,o.NTc)(h.peer.id),initials:f[0]}),Component:"label",after:(0,n.jsx)(o.Sc0,{hasHover:!1,hasActive:!1,checked:g,onChange:p}),children:f})}if("user"===h.peer.type&&c.A.has(h.peer.id)){const e=c.A.get(h.peer.id);return(0,n.jsx)(o.T6P,{before:(0,n.jsx)(r.A,{size:40,src:e.photo_50||e.photo_100,isNFT:e.is_nft,badge:e.online?"online":void 0}),Component:"label",after:(0,n.jsx)(o.Sc0,{hasHover:!1,hasActive:!1,checked:g,onChange:p}),children:f})}const _=Math.abs(h.peer.id);if("group"===h.peer.type&&l.A.has(_)){const e=l.A.get(_);return(0,n.jsx)(o.T6P,{before:(0,n.jsx)(o.euF,{size:40,src:e.photo_50||e.photo_100,gradientColor:(0,o.NTc)(_),initials:f[0]}),Component:"label",after:(0,n.jsx)(o.Sc0,{hasHover:!1,hasActive:!1,checked:g,onChange:p}),children:f})}return(0,n.jsxs)(o.T6P,{children:[h.peer.type," (",h.peer.id,")"]})}},29783:(e,t,s)=>{s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>p});var r=s(74848),o=s(45880),a=s(58006),i=s(8015),l=s(39107),c=s(11092),d=s(39044),u=s(15200),h=e([i]);i=(h.then?(await h)():h)[0];const f=({ListItem:e,width:t,height:s})=>{const{filteredItems:n}=(0,u.A)(),o=(0,i.A)(),a=s-16-60-52;return 0===n.length?(0,r.jsx)(l.OrA,{style:{width:t,height:a},children:o.use("global_not_found")}):(0,r.jsx)(c.B8,{width:t,height:a,rowHeight:52,rowCount:n.length,rowRenderer:({index:t,style:s})=>(0,r.jsx)("div",{style:s,children:(0,r.jsx)(e,{index:t})},t)})},g=()=>{const{search:e,setSearch:t}=(0,u.A)();return(0,r.jsx)(l.vji,{after:null,value:e,onChange:e=>t(e.currentTarget.value)})},p=({onChange:e,items:t,ListItem:s})=>{const{width:n,ref:i,style:l}=(0,o.A)(),c=(0,a.A)();return(0,r.jsxs)(d.A,{items:t,onChange:e,children:[(0,r.jsx)("div",{ref:i,style:l}),(0,r.jsx)(g,{}),(0,r.jsx)(f,{ListItem:s,width:n,height:c})]})};n()}catch(e){n(e)}}))},15200:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(96540),r=s(2346);const o=()=>{const e=(0,n.useContext)(r.A);if(!e)throw new Error("useConfirmList must be used within a ConfirmListProvider");return e}},32859:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(52370);const r=({offset:e=0,filter:t="all",count:s=200,folder_id:r,group_id:o=0})=>{const a={offset:e,count:s,filter:t,extended:1,fields:["is_nft","photo_50"]};return r&&(a.folder_id=r),o&&(a.group_id=o),n.vkapiWrapper.messages.getConversations(a)};const o=async function*(e,t,s){const{count:n}=await r({offset:0,count:0,filter:e,folder_id:t,group_id:s});if(yield{count:n,offset:0,items:[],profiles:[],groups:[]},0===n)return;let o=0;for(;o<n;){const a=[r({offset:o,filter:e,folder_id:t,group_id:s})];o+200<n&&a.push(r({offset:o+200,filter:e,folder_id:t,group_id:s})),o+400<n&&a.push(r({offset:o+400,filter:e,folder_id:t,group_id:s}));for(const{items:e,profiles:t,groups:s}of await Promise.all(a)){if(0===e.length)return;yield{count:n,offset:o,items:e||[],profiles:t||[],groups:s||[]},o+=200}}}},99289:(e,t,s)=>{s.d(t,{A:()=>u});var n=s(96540),r=s(74225),o=s.n(r),a=s(65394),i=s(19171),l=s(66556),c=s(32859),d=s(57610);const u=(e="")=>{const[t,s]=(0,n.useState)(null),[r,u]=(0,n.useState)(null),[h,f]=(0,n.useState)(null),[g,p]=(0,n.useState)(0),[_,v]=(0,n.useState)(0),A=(0,d.F9)();return o()((async t=>{if(""===e)return;s(null),u(null),f(null),p(0),v(0);const n=new Set,r=new Set,o=new Set;for await(const{offset:s,count:d,items:u,profiles:h,groups:f}of(0,c.A)(e,void 0,A)){if(!t())return;if(0===s&&(v(d),p(0)),0===d){v(s);break}for(const{conversation:e}of u)a.A.set(e.peer.id,e),n.add(e.peer.id),(e.unread_count||e.is_marked_unread)&&r.add(e.peer.id),"group"===e.peer.type&&o.add(e.peer.id);for(const e of h)l.A.set(e.id,e);for(const e of f)i.A.set(e.id,e);p(n.size)}t()&&(s(Array.from(n)),u(Array.from(r)),f(Array.from(o)))}),[e,A]),{convos:t,unreadConvos:r,groupsConvos:h,progress:g,allConvosCount:_}}},24440:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(52370),r=s(96540),o=s(74225),a=s.n(o),i=s(32859),l=s(57610);const c=()=>{const[e,t]=(0,r.useState)(null),[s,o]=(0,r.useState)(0),[c,d]=(0,r.useState)(0),u=(0,l.F9)();return a()((async e=>{if(u){if(!e())return;return t([]),o(0),void d(0)}const{items:s}=await n.vkapiWrapper.messages.getFolders({});if(!e())return;d(s.length);const r=[];for(const t of s){const s=new Set;for await(const{count:n,items:r}of(0,i.A)("all",t.id)){if(!e())return;if(0===n)break;for(const{conversation:e}of r)s.add(e.peer.id);o((e=>e+1))}if(!e())return;r.push({convos:Array.from(s),folder_id:t.id,folder_name:t.name}),o(r.length)}e()&&t(r)}),[u]),{foldersConvos:e,progress:s,allConvosCount:c}}},1058:(e,t,s)=>{s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>u});var r=s(74848),o=s(1883),a=s(8015),i=s(39107),l=s(96540),c=s(86222),d=e([a]);a=(d.then?(await d)():d)[0];const u=({all:e,archived:t,unread:s,groups:n,onSelectedChats:d,foldersConvos:u})=>{const h=(0,a.A)(),[f,g]=(0,l.useState)({all:!1,unread:!1,archived:!1,folders:new Set,groups:!1}),p=e=>{g((t=>({...t,[e]:!t[e]})))},_=(0,l.useMemo)((()=>{if(f.all)return e;const r=new Set,o=e=>{for(const t of e)r.add(t)};f.unread&&o(s),f.archived&&o(t),f.groups&&o(n);for(const e of f.folders){const t=u.find((t=>t.folder_id===e));t?.convos&&o(t.convos)}return Array.from(r)}),[e,s,t,n,u,f.all,f.unread,f.archived,f.folders,f.groups]),v=!0===f.all;return(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(i.eIh,{top:h.use("settings_cleaner_chats_select"),children:[(0,r.jsx)(i.Sc0,{disabled:0===e.length,onChange:()=>p("all"),checked:f.all,children:h.use("settings_cleaner_chats_category_all",{count:e.length})}),(0,r.jsx)(i.Sc0,{disabled:0===s.length||v,onChange:()=>p("unread"),checked:f.unread,children:h.use("settings_cleaner_chats_category_unread",{count:s.length})}),(0,r.jsx)(i.Sc0,{disabled:0===t.length||v,onChange:()=>p("archived"),checked:f.archived,children:h.use("settings_cleaner_chats_category_archived",{count:t.length})}),(0,r.jsx)(i.Sc0,{disabled:0===n.length||v,onChange:()=>p("groups"),checked:f.groups,children:h.use("settings_cleaner_chats_category_groups",{count:n.length})})]}),u.length>0&&(0,r.jsx)(i.eIh,{top:h.use("settings_cleaner_chats_category_folders"),className:c.A.ClearFriends__longTime,children:u.map((({folder_id:e,folder_name:t,convos:s})=>(0,r.jsxs)(i.Sc0,{disabled:0===s.length||v,onChange:()=>{g((t=>{const s=new Set(t.folders);return s.has(e)?s.delete(e):s.add(e),{...t,folders:s}}))},checked:f.folders.has(e),children:[t," (",s.length,")"]},e)))}),(0,r.jsx)(i.iau,{children:(0,r.jsx)(i.lZ$,{extraSubtitle:(0,r.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:h.use("settings_cleaner_chats_warning")})})}),(0,r.jsx)(i.eIh,{children:(0,r.jsx)(i.$nd,{mode:"primary",stretched:!0,size:"m",disabled:0===_.length,onClick:()=>d(_),children:h.use("settings_cleaner_default_clear_button",{count:_.length})})})]})};n()}catch(e){n(e)}}))},48067:(e,t,s)=>{s.a(e,(async(e,n)=>{try{s.r(t),s.d(t,{default:()=>y});var r=s(74848),o=s(52370),a=s(7139),i=s(1883),l=s(85252),c=s(8015),d=s(68741),u=s(48081),h=s(39107),f=s(96540),g=s(58207),p=s(29783),_=s(46651),v=s(49747),A=s(23050),m=s(99289),x=s(24440),C=s(57610),j=s(1058),w=e([a,c,g,p,v,j]);[a,c,g,p,v,j]=w.then?(await w)():w;const S=()=>{const e=(0,c.A)(),[t,s]=(0,f.useState)(null),{convos:n,unreadConvos:g,groupsConvos:w,progress:S,allConvosCount:y}=(0,m.A)("all"),{convos:b,progress:I,allConvosCount:k}=(0,m.A)("archive"),{foldersConvos:T,progress:F,allConvosCount:P}=(0,x.A)(),L=(0,C.F9)(),[z,M]=(0,f.useState)(0),[U,$]=(0,f.useState)(null),[E,H]=(0,f.useState)(null),[N]=(0,l.A)(),O=(0,u.Gz)(),Z=0===L,G=async()=>{if(E)if(N){M(0),s(E.length);for(const e of E){try{await o.vkapiWrapper.messages.deleteConversation({group_id:L,peer_id:e})}catch(e){console.error(e)}M((e=>e+1))}}else O.push(d.JZ.root.main.prime)};return null===b||null===n||null===g||null===T||null===w?(0,r.jsxs)(i.A,{children:[(0,r.jsx)(A.A,{value:S,max:y,label:e.use("settings_cleaner_chats_getting_all")}),(0,r.jsx)(A.A,{value:I,max:k,label:e.use("settings_cleaner_chats_getting_archived")}),Z&&(0,r.jsx)(A.A,{value:F,max:P,label:e.use("settings_cleaner_chats_getting_folders")})]}):null!==t?z===t?(0,r.jsx)(v.A,{}):(0,r.jsx)(i.A,{children:(0,r.jsx)(A.A,{value:z,max:t,label:e.use("settings_cleaner_chats_removing")})}):null!==U&&null!==E?(0,r.jsxs)(h.YJl,{children:[(0,r.jsx)(p.A,{items:U,onChange:e=>H(e),ListItem:_.A}),(0,r.jsx)(h.eIh,{children:(0,r.jsx)(h.$nd,{mode:"primary",stretched:!0,size:"m",disabled:0===E.length,onClick:G,after:(0,r.jsx)(a.A.Prime,{}),children:e.use("settings_cleaner_default_clear_button",{count:E.length})})})]}):(0,r.jsx)(j.A,{all:n,archived:b,unread:g,groups:w,foldersConvos:T,onSelectedChats:e=>{N?($(e),H(e)):O.push(d.JZ.root.main.prime)}})},y=()=>{const e=(0,c.A)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{children:e.use("settings_menu_cleaner_chats_title")}),(0,r.jsx)(S,{})]})};n()}catch(e){n(e)}}))},4255:(e,t,s)=>{s.d(t,{A:()=>r});const n=Object.freeze({isUserId:e=>e>=1&&e<19e8||e>=2e11&&e<1e12,isGroupId:e=>e<=-1&&e>-1e9,isChatId:e=>e>2e9&&e<21e8,convertChatPeerIdToChatId:e=>e-2e9,convertChatIdToChatPeerId:e=>e+2e9,isZeroOwner:e=>0===e,isUserIdTransitional:e=>(n.isUserId(e),0<e&&e<2e9)}),r=n},86222:(e,t,s)=>{s.d(t,{A:()=>n});const n={ClearFriends__longTime:"mFLvCUXoYa1xmUcY"}}}]);