"use strict";(globalThis.webpackChunkvknext=globalThis.webpackChunkvknext||[]).push([[4199],{48336:(e,n,s)=>{s.a(e,(async(e,t)=>{try{s.d(n,{default:()=>j});var o=s(74848),a=s(3178),c=s(39107),i=s(96540),r=s(74225),l=s.n(r),u=s(90275),A=s(89230),d=s(4255),h=s(99381),g=s(84833),m=s(67078),f=s(87675),x=s(1003),v=s(40473),p=e([f,v]);[f,v]=p.then?(await p)():p;const k=(0,i.createContext)([null,h.A]),w=()=>{const[e]=(0,i.useContext)(k),n=(0,f.A)(),[s,t]=(0,i.useState)(!1),[a,r]=(0,i.useState)(null),[u,h]=(0,i.useState)([]);return(0,i.useLayoutEffect)((()=>{window.stManager&&window.stManager.add(window.stDeps["/css/al/im.css"])}),[]),l()((async n=>{if(null===e)return;if(!e.length)return t(!0);const s={},o=e[0].from_id;if(o){if(d.A.isUserId(o)){const e=(await window.vkApi.api("users.get",{user_ids:o,fields:"photo_50"}))[0];e.name=`${e.first_name} ${e.last_name}`,s[o]=e}else{let e=await window.vkApi.api("groups.getById",{group_ids:-o,fields:"photo_50"});e=(e.groups||e)[0],s[o]=e}n()&&(r(s),h(e))}}),[e]),s?(0,o.jsx)(c.OrA,{children:n.use("global_not_found")}):u.length?(0,o.jsx)(v.A,{messages:u,users:a,isEdit:!0}):(0,o.jsx)(c.YJl,{children:[...Array(5).keys()].map((e=>(0,o.jsx)(A.A,{},e)))})},_=({messageId:e})=>{const[n,t]=(0,i.useContext)(k),[r,l]=(0,i.useState)(!1),A=(0,f.A)(),d=(0,x.A)();return(0,i.useEffect)((()=>{if(!n)return l(!1);Object.keys(n).length?l(!0):l(!1)}),[n]),r?(0,o.jsx)(u.Ku,{trigger:"hover",placement:"bottom-end",actions:(0,o.jsx)(u.vH,{onClick:async()=>{(await s.e(1691).then(s.bind(s,31691))).default.setMessages(`${d}_${e}`,[]),t([]),(0,m.A)({type:"done",text:A.use("vkcom_messages_history_cleared")}),l(!1)},children:A.use("vkcom_messages_history_clear")}),children:(0,o.jsx)(c.qAe,{"aria-label":A.use("global_close"),onClick:h.A,hasActive:!1,children:(0,o.jsx)(a.o,{})})}):null},j=({messageId:e})=>{const[n,t]=(0,i.useState)(null),a=(0,f.A)();return l()((async n=>{const o=(await s.e(1691).then(s.bind(s,31691))).default,a=(0,x.A)(),c=await o.getMessages(`${a}_${e}`,[]);n()&&t(c)}),[]),(0,o.jsx)(k.Provider,{value:[n,t],children:(0,o.jsx)(g.A,{header:(0,o.jsx)(c.aO9,{after:(0,o.jsx)(_,{messageId:e}),children:a.use("vkcom_message_history")}),size:500,children:(0,o.jsx)(w,{})})})};t()}catch(e){t(e)}}))},87675:(e,n,s)=>{s.a(e,(async(e,t)=>{try{s.d(n,{A:()=>a});var o=s(93819);const e=await o.A,a=()=>e;t()}catch(e){t(e)}}),1)},7646:(e,n,s)=>{s.d(n,{A:()=>c});var t=s(74848),o=s(39107),a=s(42335);const c=({className:e,children:n,getRootRef:s,useScrollView:c,...i})=>c?(0,t.jsx)(o.guY,{getRootRef:s,className:(0,o.xWm)(a.A.ActionsMenu,e),children:n}):(0,t.jsx)("div",{ref:s,...i,className:(0,o.xWm)(a.A.ActionsMenu,e),children:n})},62882:(e,n,s)=>{s.d(n,{A:()=>r});var t=s(74848),o=s(39107),a=s(53339);const c={large:a.A["ActionsMenuAction--size-large"],regular:a.A["ActionsMenuAction--size-regular"],max:a.A["ActionsMenuAction--size-max"]},i={primary:a.A["ActionsMenuAction--primary"],secondary:a.A["ActionsMenuAction--secondary"],danger:a.A["ActionsMenuAction--danger"],warning:a.A["ActionsMenuAction--warning"]},r=({leftIcon:e,rightIcon:n,title:s,subtitle:r,type:l="secondary",size:u="regular",isActive:A=!1,hasHover:d=!0,isLoading:h,className:g,onClick:m,titleClassName:f,getRootRef:x,href:v,Component:p=(v?"a":"button"),children:k,...w})=>(0,t.jsxs)(p,{className:(0,o.xWm)(a.A.ActionsMenuAction,d&&a.A["ActionsMenuAction--hover"],(m||d||v)&&a.A["ActionsMenuAction--clickable"],i[l],h&&a.A["ActionsMenuAction--loading"],A&&a.A["ActionsMenuAction--active"],c[u],g),onClick:h?void 0:m,ref:x,href:v,...w,children:[e&&(0,t.jsx)("i",{className:a.A.ActionsMenuAction__icon,children:e}),(0,t.jsxs)("span",{title:s,className:(0,o.xWm)(a.A.ActionsMenuAction__title,f),children:[k,r&&(0,t.jsx)("span",{className:a.A.ActionsMenuAction__subtitle,children:r})]}),n&&(0,t.jsx)("i",{className:a.A.ActionsMenuAction__icon,children:n})]})},22860:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(74848),o=s(75623),a=s(39107),c=s(7646);const i=({children:e,actions:n,actionsMenuClassName:s,hideOnClick:i=!0,disabled:r=!1,useScrollView:l=!1,...u})=>r?e:(0,t.jsx)(o.A,{content:(0,t.jsx)(c.A,{useScrollView:l,className:(0,a.xWm)(s),children:n}),noBackground:!0,hideOnClick:i,...u,children:e})},83558:(e,n,s)=>{s.d(n,{A:()=>c});var t=s(74848),o=s(39107),a=s(44511);const c=({getRootRef:e,className:n,...s})=>(0,t.jsx)("div",{role:"separator",className:(0,o.xWm)(a.A.ActionsMenuActionSeparator,n),ref:e,...s})},90275:(e,n,s)=>{s.d(n,{AS:()=>o.A,Ku:()=>a.A,vH:()=>t.A});s(7646);var t=s(62882),o=s(83558),a=s(22860)},75623:(e,n,s)=>{s.d(n,{A:()=>i});var t=s(74848),o=s(39107),a=s(96540),c=s(61166);const i=({hideOnClick:e=!1,noBackground:n=!1,mode:s,onClick:i,onShownChange:r,className:l,contentWrapperClassName:u,shown:A,content:d,...h})=>{const[g,m]=(0,a.useState)(!1),f=(0,a.useRef)(null),x=(0,a.useRef)(null),v=(0,a.useCallback)((e=>{e?m(!0):f.current=setTimeout((()=>{m(!1)}),100),r?.(e)}),[s,r,m]);return(0,a.useEffect)((()=>{"boolean"==typeof A&&v(A)}),[A,v]),(0,t.jsx)(o.AMh,{shown:g,className:(0,o.xWm)(c.A.PopoverReforged,n&&c.A["PopoverReforged--noBackground"],l),onShownChange:v,onClick:e=>{if("side"===s&&f.current)clearTimeout(f.current);else try{i?.(e)}catch(e){console.error(e)}},content:(0,t.jsx)("div",{ref:x,className:(0,o.xWm)(u),onClick:n=>{e&&x.current?.contains(n.target)&&m(!1)},children:d}),...h})}},42335:(e,n,s)=>{s.d(n,{A:()=>t});const t={ActionsMenu:"oXPVlZtlcjoi6d8e"}},61166:(e,n,s)=>{s.d(n,{A:()=>t});const t={PopoverReforged:"V5vFILKwsuTAoDXp","reforged-anim-fade-in":"aKnVnnmt_OsWj600","reforged-anim-fade-out":"uvPWUxQQgpV6cgFC","PopoverReforged--noBackground":"h4DVtB6f3FyJCExI"}},74225:(e,n,s)=>{var t=s(96540);function o(e,n,s){var o="function"==typeof n;t.useEffect((function(){var s,t=!0,a=e((function(){return t}));return Promise.resolve(a).then((function(e){s=e})),function(){t=!1,o&&n(s)}}),o?s:n)}e.exports=o,e.exports.useAsyncEffect=o}}]);